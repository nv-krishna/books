<!DOCTYPE html>
<!-- saved from url=(0095)https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/ -->
<html lang="en" class="applicationcache geolocation history postmessage svg websockets localstorage sessionstorage websqldatabase webworkers hashchange pointerevents canvas audio canvastext video webgl cssgradients multiplebgs opacity rgba inlinesvg hsla supports svgclippaths smil no-touchevents fontface generatedcontent textshadow cssanimations backgroundsize borderimage borderradius boxshadow csscolumns csscolumns-width csscolumns-span csscolumns-fill csscolumns-gap csscolumns-rule csscolumns-rulecolor csscolumns-rulestyle csscolumns-rulewidth csscolumns-breakbefore csscolumns-breakafter csscolumns-breakinside flexbox flexboxlegacy cssreflections csstransforms csstransforms3d csstransitions indexeddb indexeddb-deletedatabase no-hires js win chrome chrome5 webkit webkit5 ibm-grid-xlarge"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
<meta name="viewport" content="width=device-width, initial-scale=1">      
<link rel="icon" href="https://www.ibm.com/favicon.ico">
<link rel="canonical" href="http://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/index.html">
<meta name="geo.country" content="ZZ">
<meta name="dcterms.rights" content="© Copyright IBM Corporation 2016">
<meta name="dcterms.date" content="2016-07-27">
<meta name="description" content="Although microservices technology is widely associated with performance and scalability, there&#39;s no guarantee that you will achieve those objectives by using microservices in an Internet-grade environment. In this article, I show you how to develop microservices using Command Query Responsibility Segregation (CQRS) and I detail the main benefits of this type of pattern.">	
<meta name="keywords" content="axonframework, cqrs, microservices">
<meta name="robots" content="index,follow">
<title>Build an application using microservices and CQRS</title>
    
<script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/quant.js.download" id="utag_373963953"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/ebOneTag.js.download" id="ebOneTagUrlId"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/up_loader.1.1.0.js.download" id="utag_373961186"></script><script type="text/javascript" async="" charset="utf-8" id="utag_373960862" src="./Build an application using microservices and CQRS_files/js"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/up_loader.1.1.0.js.download" id="utag_2961"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/eluminate.js.download" id="tealium_cormetrics373960885"></script><script type="text/javascript" async="" src="./Build an application using microservices and CQRS_files/linkid.js.download"></script><script type="text/javascript" async="" defer="" src="./Build an application using microservices and CQRS_files/piwik.js.download"></script><script async="" src="./Build an application using microservices and CQRS_files/analytics.js.download"></script><script src="./Build an application using microservices and CQRS_files/utag.js.download" type="text/javascript" async=""></script><script> 
    digitalData = {
        "page":{
            "category":{
                "primaryCategory":"SOFDCCLDZZ"
            },
            "pageInfo":{
                "effectiveDate":"2016-07-27",
                "language":"en",
                "publishDate":"2016-07-27",
                "publisher":"IBM Corporation",
                "version":"v18",
                "ibm":{ 
                    "contentDelivery":"IBM developerWorks template",
                    "contentProducer":"IBM developerWorks",
                    "country":"ZZ",
                    "owner":"developerWorks Content/Raleigh/IBM",
                    "subject":"SWU00",
                    "type":"CT316",
                    "topic":"Application development,Bluemix",
                    "contentArea":"cloud",
                },
                "keywords":"axonframework, cqrs, microservices",
                "description":"Although microservices technology is widely associated with performance and scalability, there's no guarantee that you will achieve those objectives by using microservices in an Internet-grade environment. In this article, I show you how to develop microservices using Command Query Responsibility Segregation (CQRS) and I detail the main benefits of this type of pattern."
            }
        }
    }; 
</script>
	
    <meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@developerworks">
<meta property="og:title" content="Build an application using microservices and CQRS">
<meta property="og:description" content="Although microservices technology is widely associated with performance and scalability, there&#39;s no guarantee that you will achieve those objectives by using microservices in an Internet-grade environment. In this article, I show you how to develop microservices using Command Query Responsibility Segregation (CQRS) and I detail the main benefits of this type of pattern.">
    <meta property="og:image" content="http://www.ibm.com/developerworks/i/dw-social-201508.png">
<!-- SITE MON : START (DO NOT DELETE) -->
<!-- developerWorks monitoring token -->
<!-- SITE MON : END (DO NOT DELETE) -->

<!-- HEADER_SCRIPTS_AND_CSS_INCLUDE -->
<script src="./Build an application using microservices and CQRS_files/5399420604.js.download"></script>
<!-- BEGIN: Use this section to set page specific variables for the Page Tag -->
<script language="JavaScript">var NTPT_PGEXTRA="ibmSkillLevel=3&ibmCmaId=1034486&ibmContentAreas=cloud";</script>
<!--END -->
<script src="./Build an application using microservices and CQRS_files/ida_stats.js.download"></script>
<link href="./Build an application using microservices and CQRS_files/www.css" rel="stylesheet">
<link href="./Build an application using microservices and CQRS_files/syntaxhighlighter.css" rel="stylesheet">
<script src="./Build an application using microservices and CQRS_files/www.js.download"></script><style></style>
<script src="./Build an application using microservices and CQRS_files/syntaxhighlighter.js.download"></script>    
<link href="./Build an application using microservices and CQRS_files/tables.css" rel="stylesheet">
<script src="./Build an application using microservices and CQRS_files/tables.js.download"></script>   
<!--  Masthead/footer  -->
<link href="./Build an application using microservices and CQRS_files/dw-mf-v18.css" rel="stylesheet">
<!--[if lt IE 9]>
    <link href="//dw1.s81c.com/developerworks/css/dw-mf/v18/dw-mf-ie8fix.css?v=022216" rel="stylesheet" />
<![endif]-->
<link href="./Build an application using microservices and CQRS_files/dw-article.css" rel="stylesheet">
<script src="./Build an application using microservices and CQRS_files/dw-auth-properties.js.download"></script>
<script src="./Build an application using microservices and CQRS_files/dw-auth.js.download"></script>
<script src="./Build an application using microservices and CQRS_files/dw-mf.js.download"></script>      
<script type="text/javascript">jQuery(document).ready(function(){var $=jQuery;var dw_cclc="us-en";var dw_lang="en_US";var dw_source="dw";var dw_campaign="bluemix";var dw_content=window.location.pathname.split("/")[window.location.pathname.split("/").length-2];if(dw_content=="library"){dw_content=window.location.pathname.split("/")[window.location.pathname.split("/").length-1];dw_content=window.location.pathname.split("/")[window.location.pathname.split("/").length-3]+"-"+dw_content.substring(0,dw_content.indexOf(".html"))}var lnkID,lnkIDd,lnkIDt,bLinkEnd,bLinkTemp,idTrkr=[],idCnt;var omitList=["#","/catalog","/doc","/solutions"];$("#ibm-content-main a").each(function(index,item){var bLink=$(item).attr("href");if(bLink&&bLink.indexOf("/marketplace/cloud/developerworks/")>-1)bLink=bLink.replace("/developerworks/","/developer-program/");if(bLink&&bLink.indexOf("/marketplace/")>-1&&bLink.indexOf("/developer-program")>-1){bLink="//www.ibm.com/"+dw_cclc+"/marketplace/developer-program"}if(bLink&&(bLink.indexOf("//bluemix.net")>-1))bLink=bLink.replace("//bluemix.net","//www.bluemix.net");if(bLink&&(bLink.indexOf("//ace.ng.bluemix.net")>-1))bLink=bLink.replace("//ace.ng.bluemix.net","//www.bluemix.net");if(bLink&&(bLink.indexOf("//console.ng.bluemix.net")>-1))bLink=bLink.replace("//console.ng.bluemix.net","//www.bluemix.net");if(bLink&&((bLink.indexOf("/marketplace/developer-program")>-1)||(bLink.indexOf("developer.ibm.com/sso/bmregistration")>-1)||(bLink.indexOf("//www.bluemix.net")>-1)||(bLink.indexOf("//hub.jazz.net")>-1)||(bLink.indexOf("//developer.ibm.com/open")>-1))){var omitIt=false;for(var i=omitList.length-1;i>=0;--i){if(bLink.indexOf(omitList[i])!=-1){omitIt=true;break}}if(!(omitIt)){var linkClass="";if($(item).attr("class"))linkClass=$(item).attr("class");var dw_medium="article";if($(item).parents(".dw-article-sidebar").length!=0)dw_medium="sidebar";if($(item).children("img").length!=0)dw_medium="ad";bLinkEnd="";bLink=bLink.split("?");if((bLink[1])&&(bLink[1].indexOf("repository=")!=-1)){var deployBtn=true;bLink[0]=bLink[0]+"?"+bLink[1];bLink[1]=null}if((bLink[1])&&(bLink[1].indexOf("/")!=-1))bLinkEnd=bLink[1].substring(bLink[1].indexOf("/"));if($(item).attr("id")==null){bLinkTemp=bLink[0]+bLinkEnd;if((bLinkTemp.indexOf("developer.ibm.com/sso/bmregistration")>-1)||(bLinkTemp.indexOf(".bluemix")!=-1)){lnkIDd="bmix";if(bLinkTemp.indexOf("/#/solutions")!=-1){lnkIDd=lnkIDd+"-solution"}else if(bLinkTemp.indexOf("/solutions")!=-1){lnkIDd=lnkIDd+"-solution"}else if(bLinkTemp.indexOf("/#/store")!=-1){lnkIDd=lnkIDd+"-service"}else if(bLinkTemp.indexOf("/catalog")!=-1){lnkIDd=lnkIDd+"-service"}else if(bLinkTemp.indexOf("/docs")!=-1){lnkIDd=lnkIDd+"-docs"}else{lnkIDd=lnkIDd+"-home"}}else if(bLinkTemp.indexOf("//hub.jazz.net/")>-1){if((bLinkTemp.indexOf("//hub.jazz.net/git")>-1)||(bLinkTemp.indexOf("//hub.jazz.net/project")>-1)){lnkIDd=deployBtn?"devops-deploy":"devops-code"}else{lnkIDd=bLinkTemp.substring(bLinkTemp.indexOf("hub.jazz.net/")+13);lnkIDd=lnkIDd==""?"devops-home":"devops-"+lnkIDd.split("/")[0]}}else if(bLinkTemp.indexOf("//developer.ibm.com/open")>-1){lnkIDd=bLinkTemp.substring(bLinkTemp.indexOf("developer.ibm.com/open/")+23);if(lnkIDd.indexOf("/")!=-1)lnkIDd=lnkIDd.substring(0,lnkIDd.indexOf("/"));lnkIDd=lnkIDd.replace(/-/g,"");if(lnkIDd=="")lnkIDd="home";lnkIDd="dwopen-"+lnkIDd}else if(bLinkTemp.indexOf("/marketplace/developer-program")>-1){lnkIDd="dwpremium-marketplace"}if($(item).parent().attr("class")&&$(item).parent().attr("class").indexOf("ibm-button")!=-1){lnkIDt="btn"}else{lnkIDt="txt"}}bLink=bLink[0];if(bLink.indexOf("//developer.ibm.com/open")==-1){if(bLink.indexOf("//hub.jazz.net")>-1){if(!(deployBtn)&&((bLink.indexOf("//hub.jazz.net/git")>-1)||(bLink.indexOf("//hub.jazz.net/project")>-1))){bLink=bLink+"?utm_source="+dw_source+"&utm_medium="+dw_medium+"&utm_content="+dw_content+"&utm_campaign="+dw_campaign}else{if(deployBtn){bLink=bLink+"&cm_mmc="+dw_source+"-_-"+dw_campaign+"-_-"+dw_content+"-_-"+dw_medium}else{bLink=bLink+"?utm_source="+dw_source+"&utm_campaign="+dw_campaign+"&utm_content="+dw_content+"&utm_medium="+dw_medium}}}else{if(bLink.indexOf("/#/")==-1){if(bLink.substring(bLink.length-7)=="/docs/#"){bLink=bLink.replace("/docs/#","/docs/"+"?cm_mmc="+dw_source+"-_-"+dw_campaign+"-_-"+dw_content+"-_-"+dw_medium)}else if(bLink.substring(bLink.length-5)=="/docs"){bLink=bLink.replace("/docs","/docs/"+"?cm_mmc="+dw_source+"-_-"+dw_campaign+"-_-"+dw_content+"-_-"+dw_medium)}else if(bLink.indexOf("/marketplace/developer-program")!=-1){bLink=bLink+"?cm_sp=dwpremium"+"-_-"+dw_content+"-_-"+dw_medium;}else{bLink=bLink+"?cm_mmc="+dw_source+"-_-"+dw_campaign+"-_-"+dw_content+"-_-"+dw_medium}}else{bLink=bLink.substring(0,bLink.indexOf("#"))+"?cm_mmc="+dw_source+"-_-"+dw_campaign+"-_-"+dw_content+"-_-"+dw_medium+bLink.substring(bLink.indexOf("#")-1)}}if(bLinkEnd)bLink=bLink+bLinkEnd;if(linkClass.indexOf("bluemix-home")==-1){if((bLink.indexOf("#")==-1)&&(bLink.indexOf("/solutions")==-1)&&(bLink.indexOf("/catalog")==-1)&&((bLink.indexOf("developer.ibm.com/sso/bmregistration")!=-1)||(bLink.indexOf("//www.bluemix.net/")!=-1))){if(bLink.indexOf("//www.bluemix.net/")!=-1)bLink=bLink.replace("//www.bluemix.net/","//developer.ibm.com/sso/bmregistration");if(bLink.indexOf("http://")==0)bLink=bLink.replace("http://","https://");if(bLink.indexOf("//")==0)bLink=bLink.replace("//","https://");if(bLink.indexOf("?cm_mmc=")!=-1)bLink=bLink.replace("?cm_mmc=","?lang="+dw_lang+"&ca=")}if((bLink.indexOf("#")==-1)&&(bLink.indexOf("/solutions")==-1)&&(bLink.indexOf("//www.bluemix.net?")!=-1)){bLink=bLink.replace("//www.bluemix.net","//developer.ibm.com/sso/bmregistration");if(bLink.indexOf("http://")==0)bLink=bLink.replace("http://","https://");if(bLink.indexOf("//")==0)bLink=bLink.replace("//","https://");if(bLink.indexOf("?cm_mmc=")!=-1)bLink=bLink.replace("?cm_mmc=","?lang="+dw_lang+"&ca=")}}if((bLink.indexOf("#")!=-1)&&(bLink.indexOf("solutions")!=-1)){bLinkTemp=bLink.substring(0,bLink.indexOf("?"));bLink=bLink.substring(bLink.indexOf("/#/")+3,bLink.length);bLink=bLinkTemp+bLink;bLinkTemp=bLink.substring(0,bLink.indexOf("solution="));bLink=bLink.substring(bLink.indexOf("/solution=")+10,bLink.length);bLink=bLinkTemp+bLink;bLink=bLink+"?cm_mmc="+dw_source+"-_-"+dw_campaign+"-_-"+dw_content+"-_-"+dw_medium}if((bLink.indexOf("#")!=-1)&&(bLink.indexOf("store")!=-1)){if(bLink.indexOf("&cloudOEPaneId=store")!=-1){bLinkTemp=bLink.split("&cloudOEPaneId=store");bLink=bLinkTemp[0]}bLinkTemp=bLink.substring(bLink.indexOf("serviceOfferingGuid=")+20,bLink.length);bLink=bLink.substring(0,bLink.indexOf(".net/")+5)+"catalog/"+bLinkTemp+"?cm_mmc="+dw_source+"-_-"+dw_campaign+"-_-"+dw_content+"-_-"+dw_medium}}if(bLink.indexOf("/marketplace/developer-program")!=-1){if(bLink.indexOf("http://")==0)bLink=bLink.replace("http://","https://");if(bLink.indexOf("//")==0)bLink=bLink.replace("//","https://");$(item).attr("href",bLink)}if($(item).attr("id")==null){lnkID="article-main-"+lnkIDd+"-"+lnkIDt;idCnt=0;$(idTrkr).each(function(index,item){if(item.indexOf(lnkID)!=-1){idCnt++}});if(idCnt>0){lnkID=lnkID+"-"+idCnt}$(item).attr("id",lnkID);idTrkr.push(lnkID)}else{lnkID=$(item).attr("id")}$(item).attr("href",bLink);$(item).attr("onclick","trkOBL('"+bLink+"','"+lnkID+"'); return false;");}}})});</script><script src="./Build an application using microservices and CQRS_files/dw-article.js.download"></script>

<!-- 
<PageMap>
    <DataObject type="document">
        <Attribute name="topic">Application development,Bluemix</Attribute>
        <Attribute name="topicId">263,1237</Attribute>
        <Attribute name="contentArea">cloud</Attribute>
        <Attribute name="contentAreaId">47</Attribute>
        <Attribute name="abstract">Although microservices technology is widely associated with performance
            and scalability, there's no guarantee that you will achieve those objectives
            by using microservices in an Internet-grade environment. In this article, I
            show you how to develop microservices using Command Query Responsibility
            Segregation (CQRS) and I detail the main benefits of this type of pattern.</Attribute>
        <Attribute name="pub.date">2016-07-27</Attribute>
    </DataObject>
</PageMap>
-->        

<style id="ibm-sitenav-menu-hidelinks">@media screen and (max-width: 662px) { .ibm-sitenav-menu-list{display:none} }</style><style id="ibm-masthead-hidelinks">@media screen and (max-width: 588px) { .ibm-masthead-categories,#ibm-megamenu-sections{display:none} }@media screen and (max-width: 588px) { .ibm-mh-marketplace-link{display:none} }</style><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.373965388.js.download" id="utag_ibm.main_373965388"></script><style type="text/css" class="jquery-comments-css">.jquery-comments ul.navigation li.active:after {background: #2793e6 !important;</style><style type="text/css" class="jquery-comments-css">.jquery-comments ul.navigation ul.dropdown li.active {background: #2793e6 !important;</style><style type="text/css" class="jquery-comments-css">.jquery-comments .highlight-background {background: #2793e6 !important;</style><style type="text/css" class="jquery-comments-css">.jquery-comments .highlight-font {color: #2793e6 !important;}</style><style type="text/css" class="jquery-comments-css">.jquery-comments .highlight-font-bold {color: #2793e6 !important;font-weight: bold;}</style><link type="text/css" rel="stylesheet" href="./Build an application using microservices and CQRS_files/1.css"><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.373960885.js.download" id="utag_ibm.main_373960885"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.684.js.download" id="utag_ibm.main_684"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.694.js.download" id="utag_ibm.main_694"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.699.js.download" id="utag_ibm.main_699"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.752.js.download" id="utag_ibm.main_752"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.763.js.download" id="utag_ibm.main_763"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.797.js.download" id="utag_ibm.main_797"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.1150.js.download" id="utag_ibm.main_1150"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.1172.js.download" id="utag_ibm.main_1172"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.1197.js.download" id="utag_ibm.main_1197"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.1260.js.download" id="utag_ibm.main_1260"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.1278.js.download" id="utag_ibm.main_1278"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.1897.js.download" id="utag_ibm.main_1897"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.2041.js.download" id="utag_ibm.main_2041"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.2778.js.download" id="utag_ibm.main_2778"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.2903.js.download" id="utag_ibm.main_2903"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.2947.js.download" id="utag_ibm.main_2947"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.2956.js.download" id="utag_ibm.main_2956"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.2961.js.download" id="utag_ibm.main_2961"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.3236.js.download" id="utag_ibm.main_3236"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.1175.js.download" id="utag_ibm.main_1175"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.3738211.js.download" id="utag_ibm.main_3738211"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.373960871.js.download" id="utag_ibm.main_373960871"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.373960872.js.download" id="utag_ibm.main_373960872"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.3739516.js.download" id="utag_ibm.main_3739516"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.3739524.js.download" id="utag_ibm.main_3739524"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.373957894.js.download" id="utag_ibm.main_373957894"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.373959055.js.download" id="utag_ibm.main_373959055"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.373959377.js.download" id="utag_ibm.main_373959377"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.373960862.js.download" id="utag_ibm.main_373960862"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.373961186.js.download" id="utag_ibm.main_373961186"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.373961191.js.download" id="utag_ibm.main_373961191"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.373961464.js.download" id="utag_ibm.main_373961464"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.373961467.js.download" id="utag_ibm.main_373961467"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.373962110.js.download" id="utag_ibm.main_373962110"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.373963950.js.download" id="utag_ibm.main_373963950"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.373963953.js.download" id="utag_ibm.main_373963953"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.373964975.js.download" id="utag_ibm.main_373964975"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.373965728.js.download" id="utag_ibm.main_373965728"></script><script async="" src="./Build an application using microservices and CQRS_files/hotjar-42920.js.download"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.v.js.download" id="tiqapp"></script><script language="javascript" type="text/javascript" src="./Build an application using microservices and CQRS_files/50200000.js.download"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/i.js.download" id="tealium_setTTDid"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/utag.373960891.js.download" id="utag_ibm.main_373960891"></script><script language="javascript" type="text/javascript" src="./Build an application using microservices and CQRS_files/rules_50200000.js.download"></script><script language="javascript" type="text/javascript" src="./Build an application using microservices and CQRS_files/dispatcher-v3.js.download"></script><script language="javascript" type="text/javascript" src="./Build an application using microservices and CQRS_files/50200000.js.download"></script><script language="javascript" type="text/javascript" src="./Build an application using microservices and CQRS_files/50200000.js.download"></script><script language="javascript" type="text/javascript" src="./Build an application using microservices and CQRS_files/50200000.js.download"></script><script language="javascript" type="text/javascript" src="./Build an application using microservices and CQRS_files/50200000.js.download"></script><script src="./Build an application using microservices and CQRS_files/yahoo-min.js.download" type="text/javascript"></script><script src="./Build an application using microservices and CQRS_files/cp-v3.js.download" type="text/javascript"></script><script src="./Build an application using microservices and CQRS_files/json-min.js.download" type="text/javascript"></script><script src="./Build an application using microservices and CQRS_files/modules-ff7d3b106250c90da6a950a49a62f342.js.download"></script><style type="text/css">iframe#_hjRemoteVarsFrame {display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;}</style><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/i.js.download" id="tealium_setTTDid"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/0157fc2fa343008ac86622d386c00506d0039065009dc" id="tealium_visitor_service_1175main"></script><script type="text/javascript" async="" charset="utf-8" src="./Build an application using microservices and CQRS_files/0157fc2fa343008ac86622d386c00506d0039065009dc(1)" id="tealium_visitor_service_1175main"></script></head>
<body id="ibm-com" class="ibm-type ibm-sitenav-menu">
	
<div id="ibm-top" class="ibm-landing-page dw-sitenav">

<!-- MASTHEAD_BEGIN -->
<div id="ibm-masthead" role="banner" aria-label="IBM" class="ibm-mhtype-minimal">
    <div id="ibm-mast-options">
        <ul role="toolbar" aria-labelledby="ibm-masthead">
            <li id="ibm-geo" role="presentation"><a href="http://www.ibm.com/planetwide/select/selector.html" role="button" aria-label="United States selected - Choose a country">United States</a></li>
        </ul>
    </div>
    <div id="ibm-universal-nav" class="">    
  
        <nav role="navigation" aria-label="IBM">
            <div id="ibm-home" class="ibm-animate"><a href="http://www.ibm.com/us/en/?lnk=m">IBM®</a></div>
            <ul id="ibm-menu-links" role="toolbar" aria-label="Site map" class="ibm-hide">
                <li><a href="http://www.ibm.com/sitemap/us/en/">Site map</a></li>
            </ul><div class="ibm-masthead-rightside"><p class="ibm-mh-marketplace-link ibm-button-link ibm-fleft ibm-padding-bottom-0"><a class="ibm-btn-small ibm-btn-sec ibm-btn-blue-50" href="http://www.ibm.com/marketplace/?lnk=mp">Marketplace</a></p><div id="ibm-search-module" role="search" aria-labelledby="ibm-masthead" class="ibm-has-scope">
            <div class="ibm-masthead-search-close"><p class="ibm-ind-link ibm-icononly ibm-padding-bottom-0"><a href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#" class="ibm-close-link ibm-nospacing">Close</a></p></div><form id="ibm-search-form" action="https://www.ibm.com/Search/" method="get">
                <p>
                    <label for="q">IBM</label>
                    <input type="text" maxlength="100" value="" placeholder="Search" name="q" id="q" aria-label="Search developerWorks" autocomplete="off" role="combobox" aria-autocomplete="list" aria-expanded="true" aria-owns="ibm-search-typeahead-container"><input name="lnk" type="hidden" value="mhsrch">
                    <input type="hidden" value="18" name="v">
                    <input type="hidden" value="utf" name="en">
                    <input type="hidden" value="en" name="lang">
                    <input type="hidden" value="us" name="cc">
                    <input type="hidden" name="sn" value="dw">
                    <input type="hidden" name="dws" value="dw">
                    <input type="hidden" name="hpp" value="20">
                    <span class="ibm-search-scope ibm-fadeout"><input class="ibm-styled-checkbox" data-init="false" type="checkbox" name="sn" value="" id="ibm-mh-scopeoption"> <label for="ibm-mh-scopeoption">In Marketplace</label></span><button role="button" type="submit" id="ibm-search" class="ibm-search-link" value="Submit"><span class="ibm-access">Submit</span></button>
                </p>
            </form><form class="ibm-hide" id="ibm-default-scope-form" action="https://www.ibm.com/marketplace/search/us/en-us/" method="get"><input name="terms" type="text"><input name="lnk" type="hidden" value="mhmpsrch"></form>
        </div><div id="ibm-search-typeahead-container" class="ibm-search-typeahead-container ibm-fadeout"></div><ul aria-label="Tools" role="menubar" class="ibm-masthead-iconsonly"><li role="presentation" class="ibm-masthead-item-signin"><button role="menubutton" class="ibm-profile-link">My IBM</button><ul id="ibm-signin-minimenu-container" role="menu" aria-label="Profile" class="ibm-dropdown-menu"><li role="presentation"><a role="menuitem" href="https://www.ibm.com/developerworks/dwwi/jsp/ssologin.jsp?d=https%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fcloud%2Flibrary%2Fcl-build-app-using-microservices-and-cqrs-trs%2F&amp;lang=en_US&amp;a=dwmav">Sign in</a></li><li role="presentation"><a role="menuitem" href="https://www.ibm.com/developerworks/dwwi/jsp/ssoregister.jsp?d=https%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fcloud%2Flibrary%2Fcl-build-app-using-microservices-and-cqrs-trs%2F&amp;lang=en_US&amp;a=dwmav">Register</a></li></ul></li><li role="presentation" class="ibm-masthead-item-menu"><button role="menubutton" class="ibm-menu-link">Site navigation</button></li></ul></div> 
        </nav>
  
        
       
    </div>
</div><div class="ibm-mobilemenu ibm-hide" aria-labelledby="ibm-burgermenu-a11y" role="dialog" tabindex="0"><p class="ibm-hide" id="ibm-burgermenu-a11y">Site navigation</p><div class="ibm-mobilemenu-close"><p class="ibm-icononly ibm-fright ibm-ind-link ibm-nospacing"><a class="ibm-close-link" href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/?lnk=hm#">Close</a></p></div><div class="ibm-mobilemenu-section ibm-mobilemenu-sitenavmenu"><ul role="menubar"><li class="ibm-mobile-section-heading ibm-mobile-sitename">
        <a href="https://www.ibm.com/developerworks/?lnk=hm">
            <img width="186" height="24" alt="developerWorks®" src="./Build an application using microservices and CQRS_files/dw-mf-wordmark.svg">
        </a>
    </li>
                            <li class="dw-navpage-learn ibm-haschildlist" role="presentation"><a href="https://www.ibm.com/developerworks/learn/?lnk=hm">Learn</a></li>
                    
                <li role="presentation" class="dw-navpage-develop ibm-haschildlist"><a href="https://www.ibm.com/developerworks/develop/?lnk=hm">Develop</a></li>
 
            
                <li role="presentation" class="dw-navpage-connect ibm-haschildlist"><a href="https://www.ibm.com/developerworks/connect/?lnk=hm">Connect</a></li> 
            
                <!-- dW featured -->
                <!-- <li role="presentation" class="dw-navpage-devcenter"><strong>Subheading</strong></li> -->
                <li role="presentation" class="dw-navpage-devcenter"><a role="menuitem" href="https://developer.ibm.com/blockchain/?lnk=hm">IBM Blockchain</a></li>    
                <li role="presentation" class="dw-navpage-devcenter"><a role="menuitem" href="https://developer.ibm.com/career-concierge/?lnk=hm">Career Concierge</a></li>
                <li role="presentation" class="dw-navpage-devcenter"><a role="menuitem" href="https://developer.ibm.com/open/?lnk=hm">dW Open</a></li>
                <li role="presentation" class="dw-navpage-devcenter"><a role="menuitem" href="https://developer.ibm.com/architecture/?lnk=hm">Architecture Center</a></li>
                <!-- <li role="presentation" class="dw-navpage-devcenter"><a role="menuitem" href="//developer.ibm.com/swift/">Swift @ IBM</a></li>  -->
        </ul></div><div class="ibm-mobilemenu-section"><ul class="ibm-mobilemenu-mhlinks" aria-label="Discover IBM"><li><a href="http://www.ibm.com/marketplace/?lnk=hmmp">Marketplace</a></li><li><div data-widget="showhide" data-type="panel" class="ibm-show-hide ibm-widget-processed"><h2><a href="javascript:void();">Products</a></h2><div class="ibm-container-body" style="display: none;"><ul><li><a href="http://www.ibm.com/products/en-us/?lnk=hmhmpr"><span>All products</span></a></li><li><a href="http://www.ibm.com/analytics/us/en/?lnk=hmmpr_bua&amp;lnk2=learn"><span>Analytics</span></a></li><li><a href="http://www.ibm.com/cloud-computing/?lnk=hmmpr_bucl"><span>Cloud</span></a></li><li><a href="http://www.ibm.com/cognitive/?lnk=hmmpr_buce&amp;lnk2=learn"><span>Cognitive</span></a></li><li><a href="http://www.ibm.com/commerce/us-en/?lnk=hmmpr_bucom&amp;lnk2=learn"><span>Commerce</span></a></li><li><a href="http://www.ibm.com/internet-of-things/?lnk=hmmpr_iot&amp;lnk2=learn"><span>Internet of Things</span></a></li><li><a href="http://www.ibm.com/industries/?lnk=hmmpr_ind&amp;lnk2=learn"><span>Industry solutions</span></a></li><li><a href="http://www.ibm.com/it-infrastructure/us-en/?lnk=hmmpr_buit&amp;lnk2=learn"><span>IT infrastructure</span></a></li><li><a href="http://www.ibm.com/mobile/?lnk=hmmpr_bumf&amp;lnk2=learn"><span>Mobile</span></a></li><li><a href="http://www.ibm.com/security/?lnk=hmmpr_buse&amp;lnk2=learn"><span>Security</span></a></li><li><a href="https://www.ibm.com/social-business/us-en/?lnk=hmmpr_buso"><span>Social</span></a></li><li><a href="http://www.ibm.com/smarterplanet/us/en/ibmwatson/?lnk=hmmpr_buwa&amp;lnk2=learn"><span>Watson</span></a></li><li><a href="http://www.ibm.com/watson/health/?lnk=hmmpr_buwh"><span>Watson Health</span></a></li></ul></div></div></li><li><div data-widget="showhide" data-type="panel" class="ibm-show-hide ibm-widget-processed"><h2><a href="javascript:void();">Services</a></h2><div class="ibm-container-body" style="display: none;"><ul><li><a href="http://www.ibm.com/services/us/gbs/consulting/?lnk=hmmse_bc&amp;lnk2=learn"><span>Business consulting</span></a></li><li><a href="http://www.ibm.com/services/?lnk=hmmse_ts&amp;lnk2=learn"><span>Technology services</span></a></li><li><a href="https://www.ibm.com/financing/us-en/?lnk=hmmse_fin&amp;lnk2=learn"><span>Financing</span></a></li><li><a href="http://www.ibm.com/industries/?lnk=hmmse_ie&amp;lnk2=learn"><span>Industry expertise</span></a></li><li><a href="http://www.ibm.com/training/?lnk=hmmse_tr&amp;lnk2=learn"><span>Training and skills</span></a></li></ul></div></div></li><li><a href="http://www.ibm.com/industries?lnk=hmmin">Industries</a></li><li><div data-widget="showhide" data-type="panel" class="ibm-show-hide ibm-widget-processed"><h2><a href="javascript:void();">Developers</a></h2><div class="ibm-container-body" style="display: none;"><ul><li><a href="http://www.ibm.com/developerworks/?lnk=hmmdev_dw&amp;lnk2=learn"><span>developerWorks</span></a></li><li><a href="https://www.ibm.com/partnerworld/?lnk=hmmdev_pw&amp;lnk2=learn"><span>PartnerWorld</span></a></li></ul></div></div></li><li><a href="http://www.ibm.com/support/en-us/?lnk=hmmsu">Support</a></li><li><a href="http://www.ibm.com/employment/?lnk=hmmca">Careers</a></li></ul></div></div><div class="ibm-mhplaceholder ibm-hide"></div><!-- MASTHEAD_END -->
	    
<!-- LAYOUT -->
<div id="ibm-content-wrapper">
    <!-- LEADSPACE_BEGIN -->
    <header role="banner" aria-labelledby="ibm-pagetitle-h1">
        
        <!-- MASTHEAD_SITENAV_BEGIN -->
        <div class="ibm-sitenav-menu-container" data-widgetprocessed="true">
    <div class="ibm-sitenav-menu-name">
        <a href="https://www.ibm.com/developerworks/">
            <img width="186" height="24" alt="developerWorks®" src="./Build an application using microservices and CQRS_files/dw-mf-wordmark.svg">
        </a>
    </div>
    <div class="ibm-sitenav-menu-list">
        <ul role="menubar">
                            <li class="dw-navpage-learn ibm-haschildlist" role="presentation">
                    <button role="menuitem" tabindex="0" onclick="document.location=&#39;//www.ibm.com/developerworks/learn/&#39;"><a href="https://www.ibm.com/developerworks/learn/" tabindex="-1">Learn</a></button>
	                <ul role="menu" aria-label="Learn" id="dw-mega-learn" class="ibm-align-right">
	                    <li role="presentation"> 
                            <div class="ibm-columns">
    	                        <div class="ibm-col-5-3 dw-mega-main">
    	                           <h2>Learn with our tutorials and training</h2>
    	                            <p class="dw-mega-main-p">developerWorks provides tutorials, articles and other
    	                            technical resources to help you grow your development skills
    	                            on a wide variety of topics and products. Learn about a specific
    	                            product or take a course and get certified. So, what do you want to learn 
    	                            about?</p>
    	                            <p class="ibm-button-link">                                   
                                        <a href="https://www.ibm.com/developerworks/learn/" class="ibm-btn-pri">Choose a topic</a>
                                    </p>
    	                        </div>
    	                        <div class="ibm-col-5-1 dw-mega-nav">
    	                            <h3>Featured topics</h3>
    	                            
    	                            <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-mobile.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://www.ibm.com/developerworks/learn/mobile">Mobile development</a>
                                        </div>
    	                            </div>
    	                            <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-bigdata.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://www.ibm.com/developerworks/learn/analytics">Big data</a>
                                        </div>
    	                            </div>
    	                            <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-cognitive.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://www.ibm.com/developerworks/learn/cognitive">Cognitive computing</a>
                                        </div>
    	                            </div>
    	                            <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-cloud.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://www.ibm.com/developerworks/learn/cloud">Cloud</a>
                                        </div>
    	                            </div>       	                            
    	                        </div>	
    	                        <div class="ibm-col-5-1 dw-mega-nav">
    	                            <h3>Featured destinations</h3>
    	                
    	                            <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-swift.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://developer.ibm.com/swift/?lnk=hm">Swift @ IBM</a>
                                        </div>
    	                            </div>
    	                            <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-open.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://developer.ibm.com/open/?lnk=hm">developerWorks Open</a>
                                        </div>
    	                            </div>
    	                            <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-arch.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://developer.ibm.com/architecture/?lnk=hm">Architecture center</a>
                                        </div>
    	                            </div>
    	                            <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-premium.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://www.ibm.com/marketplace/cloud/developer-program/us/en-us?cm_sp=dwpremium-_-dwhome-_-icon">developerWorks Premium</a>
                                        </div>
    	                            </div>       	                            
    	                        </div>  
    	                                                       
    	                    </div>                             
                        </li>
                    </ul>
	            </li>
                    
                <li role="presentation" class="dw-navpage-develop ibm-haschildlist">
                   <button role="menuitem" tabindex="-1" onclick="document.location=&#39;//www.ibm.com/developerworks/develop/&#39;"><a href="https://www.ibm.com/developerworks/develop/" tabindex="-1">Develop</a></button>
                    <ul role="menu" aria-label="Develop" id="dw-mega-develop" class="ibm-align-right">
                        <li role="presentation">
                            <div class="ibm-columns">
                                <div class="ibm-col-5-3 dw-mega-main">
                                    <h2>Develop with our trials &amp; downloads</h2>
                                    <p class="dw-mega-main-p">Start developing with product trials, free downloads, and IBM Bluemix™ services.
                                    Sort by topic or product name and find everything we have to offer.</p>
                                    <p class="ibm-button-link">                                   
                                        <a href="https://www.ibm.com/developerworks/develop/" class="ibm-btn-pri">View all downloads &amp; trials</a>
                                    </p>
                                </div>
                                <div class="ibm-col-5-1 dw-mega-nav">
                                    <h3>Featured products</h3>
                                    
                                    <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-bluemix.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://developer.ibm.com/sso/bmregistration">Bluemix</a>
                                        </div>
                                    </div>
                                    <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-websphere.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://www.ibm.com/developerworks/downloads/ws/was/">Websphere Application Server</a>
                                        </div>
                                    </div>
                                    <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-db2express.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://www.ibm.com/developerworks/downloads/im/db2express/">DB2 Express C</a>
                                        </div>
                                    </div>
                                    <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-mobile.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://mobilefirstplatform.ibmcloud.com/">MobileFirst Platform Foundation</a>
                                        </div>
                                    </div>       	                            
                                </div>	
                                <div class="ibm-col-5-1 dw-mega-nav">
                                    <h3>Featured destinations</h3>
                                    
                                    <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-swift.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://developer.ibm.com/swift/?lnk=hm">Swift @ IBM</a>
                                        </div>
                                    </div>
                                    <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-open.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://developer.ibm.com/open/?lnk=hm">developerWorks Open</a>
                                        </div>
                                    </div>
                                    <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-arch.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://developer.ibm.com/architecture/?lnk=hm">Architecture center</a>
                                        </div>
                                    </div>
                                    <!--<div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="//dw1.s81c.com/developerworks/i/v18/mega/dw-mplist-premium.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="//www.ibm.com/marketplace/cloud/developer-program/us/en-us?cm_sp=dwpremium-_-dwhome-_-icon">developerWorks Premium</a>
                                        </div>
                                    </div> --> 
                                    <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-api-dest.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://developer.ibm.com/api/">API Explorer</a>
                                        </div>
                                    </div>        	                            
                                </div>  
                                
                            </div>                            
                        </li>
                    </ul>
                </li>
 
            
                <li role="presentation" class="dw-navpage-connect ibm-haschildlist">
                    <button role="menuitem" tabindex="-1" onclick="document.location=&#39;//www.ibm.com/developerworks/connect/&#39;"><a href="https://www.ibm.com/developerworks/connect/" tabindex="-1">Connect</a></button>
                    <ul role="menu" aria-label="Connect" id="dw-mega-connect" class="ibm-align-right">
                        <li role="presentation">
                            <div class="ibm-columns">
                                <div class="ibm-col-5-3 dw-mega-main">
                                    <h2>Find a community and connect</h2>
                                    <p class="dw-mega-main-p">Learn from the experts and share with other developers in one of our
                                        dev centers.  Ask questions and get answers with dW answers.  Search for local events
                                        in your area.  All in developerWorks communities.</p>
                                    <p class="ibm-button-link">                                   
                                        <a href="https://www.ibm.com/developerworks/connect/" class="ibm-btn-pri">View communities</a>
                                    </p>
                                </div>
                                <div class="ibm-col-5-1 dw-mega-nav">
                                    <h3>Featured Developer Centers</h3>
                                    
                                    <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-jazz-dev.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://jazz.net/">Jazz.net</a>
                                        </div>
                                    </div>
                                    <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-cloud-dev.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://developer.ibm.com/cloud-analytics/">IBM Cloud Analytics DEV</a>
                                        </div>
                                    </div>
                                    <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-bluemix-dev.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://developer.ibm.com/bluemix/">Bluemix</a>
                                        </div>
                                    </div>
                                    <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-api-dev.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://developer.ibm.com/api/">API Explorer</a>
                                        </div>
                                    </div>       	                            
                                </div>	
                                <div class="ibm-col-5-1 dw-mega-nav">
                                    <h3>Featured destinations</h3>
                                    
                                    <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-swift.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://developer.ibm.com/swift/?lnk=hm">Swift @ IBM</a>
                                        </div>
                                    </div>
                                    <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-open.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://developer.ibm.com/open/?lnk=hm">developerWorks Open</a>
                                        </div>
                                    </div>
                                    <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-arch.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://developer.ibm.com/architecture/?lnk=hm">Architecture center</a>
                                        </div>
                                    </div>
                                    <div class="dw-mega-nav-item">
                                        <div class="dw-mega-nav-img">
                                            <img width="30" height="30" alt="" src="./Build an application using microservices and CQRS_files/dw-mplist-premium.png">
                                        </div>
                                        <div class="dw-mega-nav-link">
                                            <a href="https://www.ibm.com/marketplace/cloud/developer-program/us/en-us?cm_sp=dwpremium-_-dwhome-_-icon">developerWorks Premium</a>
                                        </div>
                                    </div>       	                            
                                </div>  
                                
                            </div>                            
                        </li>
                    </ul>
                </li> 
            
                <!-- dW featured -->
                <!-- <li role="presentation" class="dw-navpage-devcenter"><strong>Subheading</strong></li> -->
                <li role="presentation" class="dw-navpage-devcenter"><a role="menuitem" href="https://developer.ibm.com/blockchain/">IBM Blockchain</a></li>    
                <li role="presentation" class="dw-navpage-devcenter"><a role="menuitem" href="https://developer.ibm.com/career-concierge/">Career Concierge</a></li>
                <li role="presentation" class="dw-navpage-devcenter"><a role="menuitem" href="https://developer.ibm.com/open/">dW Open</a></li>
                <li role="presentation" class="dw-navpage-devcenter"><a role="menuitem" href="https://developer.ibm.com/architecture/">Architecture Center</a></li>
                <!-- <li role="presentation" class="dw-navpage-devcenter"><a role="menuitem" href="//developer.ibm.com/swift/">Swift @ IBM</a></li>  -->
        </ul>
    </div>
</div>        <!-- MASTHEAD_SITENAV_END -->
        
        <!-- NAVIGATION_TRAIL_BEGIN -->
        <div id="ibm-leadspace-head" class="ibm-alternate">
            <div id="ibm-leadspace-body">
                <nav aria-label="Breadcrumb" role="navigation">                     
                            <ul id="dw-navigation-trail" itemscope="" itemtype="http://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem"><a itemprop="item" href="http://www.ibm.com/developerworks/learn/"><span itemprop="name">Learn</span></a><meta itemprop="position" content="1"></li><li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem"><a itemprop="item" href="http://www.ibm.com/developerworks/cloud/"><span itemprop="name">Cloud computing</span></a><meta itemprop="position" content="2"></li></ul>
                </nav>
            </div>
        </div>
        <!-- NAVIGATION_TRAIL_END -->
        
    </header>
    <!-- LEADSPACE_END -->
    
    <!-- MAIN_CONTENT_BEGIN -->
    <main role="main" aria-label=""> 
        <div id="ibm-pcon">
            <!-- BEGIN_IBM-CONTENT -->
            <div id="ibm-content">
                <!-- BEGIN_IBM-CONTENT-BODY -->
                <div id="ibm-content-body">
                    <!-- BEGIN_IBM-CONTENT-MAIN -->
                    <div id="ibm-content-main" class="dw-article">                        
                        <!-- BEGIN_INTERIOR-COLUMNS -->
                                <div class="ibm-columns dw-article-toc">
                                    <!-- LEFT_6_2_CONTENT_COLUMN_BEGIN -->  
                                    <div id="dw-article-toc-container" class="ibm-col-6-2">
                                        <div id="dw-article-toc-body" data-widget="scrollable" data-height="509" style="width: 460px; height: 509px;" class="nano has-scrollbar"><div class="nano-content" tabindex="-1" style="right: -17px;">
                                            <h2>Contents</h2><div class="ibm-alternate-rule"><hr></div><ul role="directory" aria-label="Table of contents" class="ibm-plain-list"><li class="dw-highlight"><a onclick="tocLink(&#39;#ibm-pagetitle-h1&#39;)" role="link" tabindex="0">Introduction</a></li><li class=""><a onclick="tocLink(&#39;#1Microservicesoutline&#39;)" role="link" tabindex="0">Microservices</a></li><li class=""><a onclick="tocLink(&#39;#2CQRSpatternoverviewoutline&#39;)" role="link" tabindex="0">CQRS pattern overview</a></li><li class=""><a onclick="tocLink(&#39;#3AxonFrameworkimplementationofCQRSoutline&#39;)" role="link" tabindex="0">Axon Framework implementation of
                CQRS</a></li><li class=""><a onclick="tocLink(&#39;#4STEP1Selecttheapplicationcontextasimpleshoppingcartoutline&#39;)" role="link" tabindex="0">Step 1. Select the application
                context</a></li><li><a onclick="tocLink(&#39;#5STEP2DesignCommandsandtheirhandlersoutline&#39;)" role="link" tabindex="0">Step 2. Design commands and their
                handlers</a></li><li><a onclick="tocLink(&#39;#6STEP3IdentifyEventsandtheirlistenersoutline&#39;)" role="link" tabindex="0">Step 3. Identify events and their
                listeners</a></li><li><a onclick="tocLink(&#39;#7STEP4ConfiguretheCommandhandlingoutline&#39;)" role="link" tabindex="0">Step 4. Configure the command
                handling</a></li><li><a onclick="tocLink(&#39;#8STEP5Lookingforlongrunningtransactionsoutline&#39;)" role="link" tabindex="0">Step 5. Look for long-running
                transactions</a></li><li class=""><a onclick="tocLink(&#39;#9STEP6ManageEventsourcingoutline&#39;)" role="link" tabindex="0">Step 6. Manage event sourcing</a></li><li><a onclick="tocLink(&#39;#10STEP7ChooseEventSerializationoutline&#39;)" role="link" tabindex="0">Step 7. Choose event
                serialization</a></li><li><a onclick="tocLink(&#39;#11STEP8Interactwithapplicationoutline&#39;)" role="link" tabindex="0">Step 8. Interact with the 
                application</a></li><li class=""><a onclick="tocLink(&#39;#12STEP9TheDeploymentoutline&#39;)" role="link" tabindex="0">Step 9. The deployment</a></li><li><a onclick="tocLink(&#39;#13Conclusionoutline&#39;)" role="link" tabindex="0">Conclusion</a></li><li><a onclick="tocLink(&#39;#artdownload&#39;)" role="link" tabindex="0">Downloadable resources</a></li><li class=""><a onclick="tocLink(&#39;#artrelatedtopics&#39;)" role="link" tabindex="0">Related topics</a></li><li class=""><a onclick="tocLink(&#39;#icomments&#39;)" role="link" tabindex="0">Comments</a></li></ul>
                                        </div><div class="nano-pane" style="opacity: 1; visibility: visible;"><div class="nano-slider" style="height: 345px; transform: translate(0px, 0px);"></div></div></div>
                                    </div>
                                    <!-- LEFT_6_2_CONTENT_COLUMN_END -->
                                    
                                    <!-- CENTER_6_4_CONTENT_COLUMN_BEGIN -->
                                    <div class="ibm-col-6-4">
                                        <h1 id="ibm-pagetitle-h1" class="ibm-h1">Build an application using microservices and CQRS</h1><p class="dw-article-subhead">Maximize the performance and scalability of your microservices-based
            apps</p>
                                        <!-- Article Top Bar -->
                                                <div class="ibm-columns dw-article-topbar">
                                                    <!-- Author and article info. -->
                                                    <div class="ibm-col-6-2 ibm-col-medium-6-4 dw-article-metadata">
                                                        <div class="dw-article-avatar"><img width="42" height="42" src="./Build an application using microservices and CQRS_files/p-ftucci60.jpg" alt="Felicia Tucci"></div><div class="dw-article-authordate"><span class="dw-article-author"><a href="https://it.linkedin.com/in/felicia-tucci-86763b5">Felicia Tucci</a></span><br><span class="dw-article-pubdate">Published on July 27,  2016</span></div>
                                                    </div>
                                                    <!-- Social -->
                                                    <div class="ibm-col-6-2 ibm-col-medium-6-4 ibm-col-small-6-2 dw-article-social">
                                                        <!-- Sharing links -->
                                                        <div id="dw-article-share-inline">
                                                            <div class="dw-article-sharelink-inline">
                                                                <div class="ibm-sharethispage"><h4 class="ibm-bold">Share this page</h4><p class="ibm-icononly"><a class="ibm-facebook-encircled-link" href="http://www.facebook.com/sharer.php?u=http%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fcloud%2Flibrary%2Fcl-build-app-using-microservices-and-cqrs-trs%2Findex.html&amp;t=Build%20an%20application%20using%20microservices%20and%20CQRS" data-id="facebook" onclick="return IBMCore.common.module.sharethispage.gotoUrl(window.open(), this);">Facebook</a><a class="ibm-twitter-encircled-link" href="https://twitter.com/intent/tweet?url=http%3A%2F%2Fibm.co%2F2iXzFDV&amp;text=Build%20an%20application%20using%20microservices%20and%20CQRS&amp;via=developerWorks" data-id="twitter" onclick="return IBMCore.common.module.sharethispage.gotoUrl(window.open(), this);">Twitter</a><a class="ibm-linkedin-encircled-link" href="http://www.linkedin.com/shareArticle?mini=true&amp;url=http%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fcloud%2Flibrary%2Fcl-build-app-using-microservices-and-cqrs-trs%2Findex.html&amp;title=Build%20an%20application%20using%20microservices%20and%20CQRS" data-id="linkedin" onclick="return IBMCore.common.module.sharethispage.gotoUrl(window.open(), this);">Linked In</a><a class="ibm-googleplus-encircled-link" href="https://plus.google.com/share?url=http%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fcloud%2Flibrary%2Fcl-build-app-using-microservices-and-cqrs-trs%2Findex.html&amp;t=Build%20an%20application%20using%20microservices%20and%20CQRS" data-id="googleplus" onclick="return IBMCore.common.module.sharethispage.gotoUrl(window.open(), this);">Google+</a><a class="ibm-email-encircled-link" href="mailto:?subject=Build%20an%20application%20using%20microservices%20and%20CQRS&amp;body=http%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fcloud%2Flibrary%2Fcl-build-app-using-microservices-and-cqrs-trs%2Findex.html" data-id="email" onclick="">E-mail this page</a></p></div>
                                                            </div>
                                                        </div>
                                                        <!-- Number of comments and link to comments -->
                                                        <div id="dw-article-cmts">
                                                            <div class="dw-article-cmtslink">
                                                                <a onclick="tocLink(&#39;#icomments&#39;)" href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#icomments" role="link" tabindex="0" aria-label="Comments">
                                                                    <img src="./Build an application using microservices and CQRS_files/dw-article-cmt-icon.png" width="29" height="29" alt="Comments">
                                                                </a>
                                                            </div>
                                                            <div class="dw-article-cmtslink">
                                                                <a onclick="tocLink(&#39;#icomments&#39;)" href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#icomments" role="link" tabindex="0">
                                                                    <div id="nCmts">1</div>
                                                                </a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                        <!-- Article Body -->
                                        
                                        <p>Simply put, microservices technology is a style of breaking large software
                applications into smaller services, each of which performs a
                specific task. Although microservices technology is widely associated with performance
            and scalability, there's no guarantee that you will achieve those objectives
            by using microservices in an Internet-grade environment. </p><p>In order to fully exploit the microservices promise, the technology must be
                complemented by an appropriate architectural <span data-widget="tooltip" class="tipso_style"><em>pattern</em></span> that maximizes the potential benefits of the
                approach. Command Query Responsibility Segregation (CQRS) is one of those
                patterns, and probably the most relevant.</p><p>This article explores the benefits of developing
                    microservices according to the CQRS pattern. I lead the reader through
                    the development of an example application written in Java™,
                    applying the Axon Framework, and then demonstrate the application's
                    deployment on a cloud environment or on Docker containers.</p><p class="ibm-button-link"><a class="ibm-btn-pri dw-article-btn-pri" href="https://github.com/feliciatucci/cqrs-sample.git">Get the code</a></p><div class="ibm-pull-quote ibm-h3"><blockquote><p><em class="dw-pullquote"><span class="dw-pullquote-open">“</span>Regardless of the complexity of the business logic, with these techniques the implementation of new commands, events, and event listeners can become essentially a purely mechanical and repetitive process.<span class="dw-pullquote-close">”</span></em></p></blockquote></div><h2 id="1Microservicesoutline" class="ibm-h2">Microservices</h2><p>In cloud ecosystems, microservices is not just a current architectural
                trend—it has become a requirement. Using the cloud as the standard
                support for the deployment of applications has inspired developers
                to rethink how apps are designed and developed. Microservices
                technology is an innovative new way to deal with the development of a
                cloud-native application. However, its architectural principles are
                applicable in contexts other than the cloud.</p><p>Some of the advantages of microservices include: </p><ul class="ibm-bullet-list"><li>Frequency of change</li><li>Scalability</li><li>Security</li><li>Platform (for example, operating system)</li><li>Infrastructure (such as RAM, network throughput)</li></ul><h2 id="2CQRSpatternoverviewoutline" class="ibm-h2">CQRS pattern overview</h2><p>Why should you choose the CQRS pattern to implement microservices? 
                In traditional application architecture, applications generally act on data
                to be persisted in a database. A unique database is usually used
                for data model entities, accessed for both reading and writing. The
                design of the data is driven by the 
                
                
                write and update operations to keep
                the data consistent. Developers try to
                minimize data redundancy using normalization techniques. While it's
                necessary to store data in normalized form, 
                this can be detrimental to read operations. To extract some data,
                developers need to code complex SQL queries that join data from multiple
                tables.</p><p>Furthermore, in many applications, while data is created once and modified
                only occasionally, it may be read many, many times. Therefore, the developer
                needs to pay particular attention to reading performance; the data should
                be accessed by the smallest possible number of
                queries and the business logic executed during each query should be 
                minimized. This is where the CQRS pattern comes in.</p><p><a href="http://martinfowler.com/bliki/CQRS.html">Martin Fowler</a> of
                Thoughtworks says about CQRS: "At its heart is the notion that you can use
                a different model to update information than the model you use to read
                information."</p><p>
                The CQRS pattern provides a guideline for identifying services and
                distributing various business aspects. The basic idea is to divide the
                operations that act on a domain object into two distinct categories:</p><ul class="ibm-bullet-list"><li><strong>Queries</strong>—methods that return a result and do not
                    change the system state.</li><li><strong>Commands</strong>—methods that change the system state but do
                    not return values.</li></ul><p> The good news is that queries and commands can be decoupled. The link
                between them is represented by the events generated by the command
                processing that feed the repositories for query data.</p><p>The events are persisted into the event repository. The business model
                database can therefore contain the last state of the system, but the event
                repository keeps the whole history of the data. With this separation of
                concerns, the developer is free to choose the most appropriate technology
                for each pattern component, and can (if desired) build a polyglot
                application. (For example, you could choose RDBMS for a database of
                commands, an in-memory database for an event repository, and NoSQL
                for a query database.)</p><p>Figure 1 illustrates the main pattern elements:</p><h5 id="fig1" class="ibm-h5">Figure 1. CQRS pattern</h5><img src="./Build an application using microservices and CQRS_files/elements.png" class="ibm-downsize" alt="Chart showing the CQRS pattern" height="768" width="962"><p class="ibm-ind-link"><a class="ibm-popup-link" onclick="IBMCore.common.widget.overlay.show(&#39;N100A2&#39;);return false;" href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#N100A2">View image at full size</a></p><div class="overlayrp"></div><h2 id="3AxonFrameworkimplementationofCQRSoutline" class="ibm-h2">Axon Framework implementation of
                CQRS</h2><p>A good Java implementation of the CQRS pattern is provided by <a href="http://www.axonframework.org/">Axon
                Framework</a>. This framework provides a simple programming model for
                implementing
                even complex applications, which frees up the developer to focus on the business
                logic (such as the definition of the commands and the events to generate
                and their handlers). With a strong framework configuration, you can define
                the types of command-bus, event-bus, and event-repository, as well as the
                transactional aspect between various components and the type of
                serialization for data communication. In my example, I use
                Spring to configure the framework. Note that in this case I work with only a very
                small subset of what the framework offers.</p><h2 id="4STEP1Selecttheapplicationcontextasimpleshoppingcartoutline" class="ibm-h2">Step 1. Select the application
                context</h2><p>First, you need to define the bounded context and its domain entities. In that
                way, you will define your <code>AggregateRoot</code> (for example, an
                order, clinic visit, or trip). According to the <a href="http://www.axonframework.org/docs/2.4/domain-modeling.html">Axon
                    Framework website</a>, an aggregate is "an entity or group of entities
                that is always kept in a consistent state. The aggregate root is the
                object on top of the aggregate tree that is responsible for maintaining
                this consistent state."</p><p>In my example, the bounded context is the (very simplified) cart of an
                online plant shop. As with any online shopping cart, a shopper using this cart can add items
                to it, remove them, empty the cart, view the items in the cart, and 
                proceed to checkout when they're finished shopping.</p><h5 id="N100C5" class="ibm-h5">Figure 2. ShoppingCart aggregate object</h5><img src="./Build an application using microservices and CQRS_files/shopping_cart.png" class="ibm-downsize" alt="ShoppingCart aggregate object" height="461" width="697"><p class="ibm-ind-link ibm-hide"><a class="ibm-popup-link" onclick="IBMCore.common.widget.overlay.show(&#39;N100C8&#39;);return false;" href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#N100C8">View image at full size</a></p><div class="overlayrp"></div><p>Note that an aggregate root is always recognizable by its
                <code>AggregateIdentifier</code>.</p><div class="ibm-syntax-container"><div><div id="highlighter_920781" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">public class ShoppingCart extends AbstractAnnotatedAggregateRoot {</code></div><div class="line number2 index1 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number3 index2 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">@AggregateIdentifier</code></div><div class="line number4 index3 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">private String id;</code></div><div class="line number5 index4 alt2"><code class="htmlscript spaces">&nbsp;</code>&nbsp;</div><div class="line number6 index5 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">public ShoppingCart() {</code></div><div class="line number7 index6 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">}</code></div><div class="line number8 index7 alt1"><code class="htmlscript spaces">&nbsp;</code>&nbsp;</div><div class="line number9 index8 alt2"><code class="htmlscript plain">//…..</code></div><div class="line number10 index9 alt1"><code class="htmlscript plain">}</code></div></div></td></tr></tbody></table></div></div></div><p>Into the Spring configuration, I link the aggregate root object
                (<code>ShoppingCart</code>) to its command bus and event repository:</p><div class="ibm-syntax-container"><div><div id="highlighter_13635" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">axon:aggregate-command-handler</code> <code class="htmlscript color1">id</code><code class="htmlscript plain">=</code><code class="htmlscript string">"ShoppingCartHandler"</code></div><div class="line number2 index1 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript color1">aggregate-type</code><code class="htmlscript plain">=</code><code class="htmlscript string">"cqrs.example.shoppingcart.model.ShoppingCart"</code></div><div class="line number3 index2 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript color1">repository</code><code class="htmlscript plain">=</code><code class="htmlscript string">"shoppingCartRepository"</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="line number4 index3 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript color1">command-bus</code><code class="htmlscript plain">=</code><code class="htmlscript string">"commandBus"</code> <code class="htmlscript plain">/&gt;</code></div></div></td></tr></tbody></table></div></div></div><h2 id="5STEP2DesignCommandsandtheirhandlersoutline" class="ibm-h2">Step 2. Design commands and their
                handlers</h2><p>Commands are objects that contain the data that changes the system state; they
                do not return results.</p><p>To manage the shopping cart, I have defined two commands:</p><ul class="ibm-bullet-list"><li><strong><code>AddItemCommand</code></strong>—adds a certain number of an item (in
                    this case, a plant) to the shopping cart. It is dispatched
                    asynchronously.</li><li><strong><code>RemoveItemCommand</code></strong>—removes an object already in the
                    cart, changing its availability in stock. It is dispatched
                    asynchronously, because the system doesn't need to return any response
                    to the user.</li></ul><p>Command handlers are annotated methods contained in
                <code>ShoppingCart</code> (the <code>AggregateRoot</code>) class, which
                represents the main domain object. (The annotations allow you to use
                <code>AggregateRoot</code> as a simple Plain Old Java Object, or POJO.) The
                events are generated into the related command handler methods.</p><div class="ibm-syntax-container"><div><div id="highlighter_617261" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">@CommandHandler</code></div><div class="line number2 index1 alt1"><code class="htmlscript plain">public ShoppingCart(AddItemCommand command) {</code></div><div class="line number3 index2 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">id=command.getItemId();</code></div><div class="line number4 index3 alt1"><code class="htmlscript plain">//put the business logic here</code></div><div class="line number5 index4 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">//....</code></div><div class="line number6 index5 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">apply(new ItemAddedEvent(command.getItemId()));</code></div><div class="line number7 index6 alt2"><code class="htmlscript plain">}</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="htmlscript plain">@CommandHandler</code></div><div class="line number10 index9 alt1"><code class="htmlscript plain">public ShoppingCart(RemoveItemCommand command) {</code></div><div class="line number11 index10 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">id=command.getItemId();</code></div><div class="line number12 index11 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">//put the business logic here</code></div><div class="line number13 index12 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">//....</code></div><div class="line number14 index13 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">apply(new ItemRemovedEvent(command.getItemId()));</code></div><div class="line number15 index14 alt2"><code class="htmlscript plain">}</code></div></div></td></tr></tbody></table></div></div></div><p>In some cases, you might need to perform other actions (such as validation,
                logging, or authorization) regardless of the specific type of
                command. This is possible through the Command Handler Interceptors. These
                can take action both before and after processing a command. They can also
                completely block command processing. The interceptor must implement the
                interface
                <code>org.axonframework.commandhandling.CommandHandlerInterceptor</code>.</p><h2 id="6STEP3IdentifyEventsandtheirlistenersoutline" class="ibm-h2">Step 3. Identify events and their
                listeners</h2><p> As soon as the command handling is processed, the unit of work is
                committed and any action is completed. At this point, each repository is
                notified of status changes and the registered events are sent to the event
                bus for publication. If you provide a listener to this event, it will be
                run asynchronously to the command and event generation. </p><p>In my simple application, two events can be generated:</p><ul class="ibm-bullet-list"><li><code>ItemAddedEvent</code> (by <code>AddItemCommand</code>)</li><li><code>ItemRemovedEvent</code> (by <code>RemoveItemCommand</code>)</li></ul><p>These events contain the data relevant to the event handling (for example,
                <code>itemId</code>, price, and quantity).</p><p>In the <code>ShoppingCartEventListener</code> class, I have registered a
                listener for each event.</p><div class="ibm-syntax-container"><div><div id="highlighter_316872" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">public class ShoppingCartEventListener {</code></div><div class="line number2 index1 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number3 index2 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">@EventHandler</code></div><div class="line number4 index3 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">public void onEvent(ItemAddedEvent event) {</code></div><div class="line number5 index4 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">System.out.println("Received ItemAddedEvent id:" + event.getItemId() + " on thread named "</code></div><div class="line number6 index5 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">+ Thread.currentThread().getName());</code></div><div class="line number7 index6 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">}</code></div><div class="line number8 index7 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number9 index8 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">@EventHandler</code></div><div class="line number10 index9 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">public void onEvent(ItemRemovedEvent event) {</code></div><div class="line number11 index10 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">System.out.println("Received ItemRemovedEvent id:" + event.getItemId() + " on thread named "</code></div><div class="line number12 index11 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">+ Thread.currentThread().getName());</code></div><div class="line number13 index12 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">}</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">}</code></div></div></td></tr></tbody></table></div></div></div><p>This is the right place to put the code for updating the data view on which
                the queries will act. Depending on the purpose of the listener, it is
                possible that the persistence of data is done on more than one database.
                Each database could have not only a separate model for queries, but also
                use a different technology (such as SQL DB, NoSQL DB, and so on).</p><h2 id="7STEP4ConfiguretheCommandhandlingoutline" class="ibm-h2">Step 4. Configure the command
                handling</h2><p>One of the most significant advantages of the Axon Framework is the ease of
                application configuration. In this section, I describe some of the 
                configuration choices I made in my application.</p><p>Through the command bus, each command is dispatched to its respective
                handler. The command bus definition is inserted into the configuration
                Spring file.</p><div class="ibm-syntax-container"><div><div id="highlighter_229065" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript comments">&lt;!-- Define a command bus --&gt;</code></div><div class="line number2 index1 alt1"><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">axon:command-bus</code> <code class="htmlscript color1">id</code><code class="htmlscript plain">=</code><code class="htmlscript string">"commandBus"</code> <code class="htmlscript color1">transaction-manager</code><code class="htmlscript plain">=</code><code class="htmlscript string">"transactionManager"</code> <code class="htmlscript plain">/&gt;</code></div></div></td></tr></tbody></table></div></div></div><p>In the <code>commandBus</code> definition, you'll see the transaction
                manager reference; it is used to manage the transaction during command
                handling.</p><div class="ibm-syntax-container"><div><div id="highlighter_580233" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">bean</code> <code class="htmlscript color1">id</code><code class="htmlscript plain">=</code><code class="htmlscript string">"transactionManager"</code> <code class="htmlscript color1">class</code><code class="htmlscript plain">=</code><code class="htmlscript string">"org.springframework.orm.jpa.JpaTransactionManager"</code><code class="htmlscript plain">&gt;</code></div><div class="line number2 index1 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">property</code> <code class="htmlscript color1">name</code><code class="htmlscript plain">=</code><code class="htmlscript string">"entityManagerFactory"</code> <code class="htmlscript color1">ref</code><code class="htmlscript plain">=</code><code class="htmlscript string">"entityManagerFactory"</code><code class="htmlscript plain">/&gt;</code></div><div class="line number3 index2 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">property</code> <code class="htmlscript color1">name</code><code class="htmlscript plain">=</code><code class="htmlscript string">"dataSource"</code> <code class="htmlscript color1">ref</code><code class="htmlscript plain">=</code><code class="htmlscript string">"dataSource"</code><code class="htmlscript plain">/&gt;</code></div><div class="line number4 index3 alt1"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">&lt;/</code><code class="htmlscript keyword">bean</code><code class="htmlscript plain">&gt;</code></div></div></td></tr></tbody></table></div></div></div><p>In adopting the CQRS pattern for use in your application development,
                consider this <em>transactional</em> aspect of CQRS. Commands cannot be
                lost. You need a transaction manager (to handle <span data-widget="tooltip" class="tipso_style"><strong>ACID</strong></span>
                transactions) to ensure that every command is processed and that the
                events are generated and made persistent in the event store. This holds
                true for command handling, but if you consider the entire transaction
                (from running the command to the event listener execution) in regard to
                the asynchronous characteristics of flow, it is a <strong>BASE</strong>
                transaction. BASE is an acronym for <strong>B</strong>asic
                    <strong>A</strong>vailable, <strong>S</strong>oft state,
                    <strong>E</strong>ventually consistent.</p><p><strong>Basically available</strong>—The system must ensure the
                availability of data. There will be an answer for every request.</p><p><strong>Soft state</strong>—The state of the system can change over time,
                even during periods where there is no input. That way, the system state
                is always "soft." The consistency of the data needs to be managed by the
                developer and not by the database.</p><p><strong>Eventually consistent</strong>—When new data is added to the
                system, it spreads gradually, one node at a time, to make the
                whole system consistent. The system eventually becomes fully consistent once it stops
                receiving input.</p><p>One result of this is the need to rethink the transaction rollback. In the
                BASE model, the transaction rollback is not automatic; you must design
                appropriate compensation actions for it. For example, if a user confirms
                his cart and buys the items, the application executes the related purchase
                command. If it is committed (as an ACID transaction), you can no longer
                act on it. Everything that happens next is asynchronous with respect to
                this command execution. Now, imagine that the listener of the purchase
                event has the purpose of starting the payment process. If the payment is
                not successful, the purchase command cannot be rolled back. Instead, the
                purchase must be canceled and the user notified. Figure 3 illustrates 
                this business process.</p><h5 id="N10170" class="ibm-h5">Figure 3. Transaction rollback process</h5><img src="./Build an application using microservices and CQRS_files/base_transaction.png" class="ibm-downsize" alt="Transaction rollback process" height="522" width="808"><p class="ibm-ind-link ibm-hide"><a class="ibm-popup-link" onclick="IBMCore.common.widget.overlay.show(&#39;N10173&#39;);return false;" href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#N10173">View image at full size</a></p><div class="overlayrp"></div><h2 id="8STEP5Lookingforlongrunningtransactionsoutline" class="ibm-h2">Step 5. Look for long-running
                transactions</h2><p>Complex events, such as those discussed above, are managed by special
                components that are defined by the <span data-widget="tooltip" class="tipso_style">SAGA</span> specification. SAGA is often
                defined as a "long-lived business transaction or process." The
                foundational theory behind it is to avoid the use of blocking (and
                locking) transactions across lots of resources.</p><p>In our purchase example, when a <code>ProductPurchased</code> event is
                generated in some way, a SAGA object associated with it sends a
                <code>CreateInvoice</code> command and a <code>PrepareDelivery</code>
                command.
                This is how the purchase process (or at least part of it) is
                executed.</p><p>Note that SAGA objects contain business behavior, but only in the form
                of process. This is a critical point: In their purest form, SAGA
                objects do not contain business logic.</p><h5 id="N10195" class="ibm-h5">Figure 4. Figure 4. SAGA example</h5><img src="./Build an application using microservices and CQRS_files/saga.png" class="ibm-downsize" alt="SAGA example" height="527" width="988"><p class="ibm-ind-link"><a class="ibm-popup-link" onclick="IBMCore.common.widget.overlay.show(&#39;N10198&#39;);return false;" href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#N10198">View image at full size</a></p><div class="overlayrp"></div><p>In my example, I have written the following SAGA
                object to manage the order: </p><div class="ibm-syntax-container"><div><div id="highlighter_901958" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">public class PurchaseManagementSaga extends AbstractAnnotatedSaga {</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">@StartSaga</code></div><div class="line number4 index3 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">@SagaEventHandler(associationProperty = "itemId")</code></div><div class="line number5 index4 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">public void handle(ProductPurchasedEvent event) {</code></div><div class="line number6 index5 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">// identifiers</code></div><div class="line number7 index6 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">String deliveryId = createDeliveryId();</code></div><div class="line number8 index7 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">String invoiceId = createInvoiceId();</code></div><div class="line number9 index8 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">// associate the Saga with these values before sending the commands</code></div><div class="line number10 index9 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">associateWith("shipmentId", deliveryId);</code></div><div class="line number11 index10 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">associateWith("invoiceId", invoiceId);</code></div><div class="line number12 index11 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">// send the commands</code></div><div class="line number13 index12 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">commandGateway.send(new PrepareDeliveryCommand(deliveryId));</code></div><div class="line number14 index13 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">commandGateway.send(new CreateInvoiceCommand(invoiceId));</code></div><div class="line number15 index14 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">}</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">// ...</code></div><div class="line number18 index17 alt1"><code class="htmlscript plain">}</code></div></div></td></tr></tbody></table></div></div></div><h2 id="9STEP6ManageEventsourcingoutline" class="ibm-h2">Step 6. Manage event sourcing</h2><p>In addition to CQRS, the Axon Framework also implements an event sourcing
                pattern, to link commands to the queries. The use of event sourcing brings
                a lot of benefits, the most important of which is to have a system where
                everything is traced by design. (In a traditional application, you need
                to log to know who has done what.) 
                
                All the events generated are persisted
                into the event store. </p><p>In my example, I have used a relational database for the event store, which
                is defined as follows.</p><div class="ibm-syntax-container"><div><div id="highlighter_458904" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">axon:jpa-event-store</code> <code class="htmlscript color1">id</code><code class="htmlscript plain">=</code><code class="htmlscript string">"eventStore"</code> <code class="htmlscript color1">entity-manager-provider</code><code class="htmlscript plain">=</code><code class="htmlscript string">"myEntityManagerProvider"</code></div><div class="line number2 index1 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript color1">event-serializer</code><code class="htmlscript plain">=</code><code class="htmlscript string">"eventSerializer"</code> <code class="htmlscript color1">max-snapshots-archived</code><code class="htmlscript plain">=</code><code class="htmlscript string">"2"</code> <code class="htmlscript color1">batch-size</code><code class="htmlscript plain">=</code><code class="htmlscript string">"1000"</code><code class="htmlscript plain">/&gt;</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">bean</code> <code class="htmlscript color1">id</code><code class="htmlscript plain">=</code><code class="htmlscript string">"myEntityManagerProvider"</code> <code class="htmlscript color1">class</code><code class="htmlscript plain">=</code><code class="htmlscript string">"org.axonframework.common.jpa.ContainerManagedEntityManagerProvider"</code> <code class="htmlscript plain">/&gt;</code></div></div></td></tr></tbody></table></div></div></div><p>Here is the event store's datasource definition.</p><div class="ibm-syntax-container"><div><div id="highlighter_970684" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">bean</code> <code class="htmlscript color1">id</code><code class="htmlscript plain">=</code><code class="htmlscript string">"dataSource"</code> <code class="htmlscript color1">class</code><code class="htmlscript plain">=</code><code class="htmlscript string">"org.springframework.jndi.JndiObjectFactoryBean"</code><code class="htmlscript plain">&gt;</code></div><div class="line number2 index1 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">property</code> <code class="htmlscript color1">name</code><code class="htmlscript plain">=</code><code class="htmlscript string">"jndiName"</code> <code class="htmlscript color1">value</code><code class="htmlscript plain">=</code><code class="htmlscript string">"jdbc/mydb"</code><code class="htmlscript plain">/&gt;</code></div><div class="line number3 index2 alt2"><code class="htmlscript plain">&lt;/</code><code class="htmlscript keyword">bean</code><code class="htmlscript plain">&gt;</code></div></div></td></tr></tbody></table></div></div></div><p>The <code>entityManagerFactory</code> (the bean that provides the database connections)
                is defined this way:</p><div class="ibm-syntax-container"><div><div id="highlighter_827605" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">bean</code> <code class="htmlscript color1">id</code><code class="htmlscript plain">=</code><code class="htmlscript string">"entityManagerFactory"</code> <code class="htmlscript color1">class</code><code class="htmlscript plain">=</code><code class="htmlscript string">"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean"</code><code class="htmlscript plain">&gt;</code></div><div class="line number2 index1 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">property</code> <code class="htmlscript color1">name</code><code class="htmlscript plain">=</code><code class="htmlscript string">"persistenceUnitName"</code> <code class="htmlscript color1">value</code><code class="htmlscript plain">=</code><code class="htmlscript string">"eventstoredb"</code><code class="htmlscript plain">/&gt;</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">property</code> <code class="htmlscript color1">name</code><code class="htmlscript plain">=</code><code class="htmlscript string">"jpaVendorAdapter"</code><code class="htmlscript plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">bean</code> <code class="htmlscript color1">class</code><code class="htmlscript plain">=</code><code class="htmlscript string">"org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"</code><code class="htmlscript plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">property</code> <code class="htmlscript color1">name</code><code class="htmlscript plain">=</code><code class="htmlscript string">"databasePlatform"</code> <code class="htmlscript color1">value</code><code class="htmlscript plain">=</code><code class="htmlscript string">"${hibernate.sql.dialect}"</code><code class="htmlscript plain">/&gt;</code></div><div class="line number7 index6 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">property</code> <code class="htmlscript color1">name</code><code class="htmlscript plain">=</code><code class="htmlscript string">"generateDdl"</code> <code class="htmlscript color1">value</code><code class="htmlscript plain">=</code><code class="htmlscript string">"${hibernate.sql.generateddl}"</code><code class="htmlscript plain">/&gt;</code></div><div class="line number8 index7 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">property</code> <code class="htmlscript color1">name</code><code class="htmlscript plain">=</code><code class="htmlscript string">"showSql"</code> <code class="htmlscript color1">value</code><code class="htmlscript plain">=</code><code class="htmlscript string">"${hibernate.sql.show}"</code><code class="htmlscript plain">/&gt;</code></div><div class="line number9 index8 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;/</code><code class="htmlscript keyword">bean</code><code class="htmlscript plain">&gt;</code></div><div class="line number10 index9 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;/</code><code class="htmlscript keyword">property</code><code class="htmlscript plain">&gt;</code></div><div class="line number11 index10 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">property</code> <code class="htmlscript color1">name</code><code class="htmlscript plain">=</code><code class="htmlscript string">"dataSource"</code> <code class="htmlscript color1">ref</code><code class="htmlscript plain">=</code><code class="htmlscript string">"dataSource"</code><code class="htmlscript plain">/&gt;</code></div><div class="line number12 index11 alt1"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">&lt;/</code><code class="htmlscript keyword">bean</code><code class="htmlscript plain">&gt;</code></div></div></td></tr></tbody></table></div></div></div><p>In the event store, you can find the tables DOMAINEVENTENTRY and
                SNAPSHOTEVENTENTRY (created by the framework the first time), each of
                which has the following columns:</p><h5 id="N101C1" class="ibm-h5">Figure 5. DOMAINEVENTENTRY and SNAPSHOTEVENTENTRY table details</h5><img src="./Build an application using microservices and CQRS_files/event_store.png" class="ibm-downsize" alt="Event store contents" height="212" width="966"><p class="ibm-ind-link"><a class="ibm-popup-link" onclick="IBMCore.common.widget.overlay.show(&#39;N101C4&#39;);return false;" href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#N101C4">View image at full size</a></p><div class="overlayrp"></div><p>Some sample content is shown in Figure 6. </p><h5 id="N101CC" class="ibm-h5">Figure 6. DOMAINEVENTENTRY table content
                    sample</h5><img src="./Build an application using microservices and CQRS_files/image002.png" class="ibm-downsize" alt="DOMAINEVENTENTRY table content sample" height="83" width="1240"><p class="ibm-ind-link"><a class="ibm-popup-link" onclick="IBMCore.common.widget.overlay.show(&#39;N101CF&#39;);return false;" href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#N101CF">View image at full size</a></p><div class="overlayrp"></div><p>The event bus is the mechanism that dispatches the events to their listeners.
                Each event can have one or more listeners associated with it. Using the
                default implementation, you would write:</p><div class="ibm-syntax-container"><div><div id="highlighter_243272" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">axon:event-bus</code> <code class="htmlscript color1">id</code><code class="htmlscript plain">=</code><code class="htmlscript string">"eventBus"</code><code class="htmlscript plain">/&gt;</code></div></div></td></tr></tbody></table></div></div></div><p>The framework makes two implementations available: </p><ul class="ibm-bullet-list"><li>The <code>SimpleEventBus</code> is applicable in most cases where
                    dispatching is done synchronously and locally (such as in a single <span data-widget="tooltip" class="tipso_style">JVM</span>). </li><li>The <code>ClusteringEventBus</code> is suitable when your application
                    requires <code>Events</code> to be published across multiple JVMs
                    (that is, in a cloud ecosystem). The dispatching is therefore
                    asynchronous and distributed. Figure 7 illustrates a clustering
                    event bus.<h5 id="N101EF" class="ibm-h5">Figure 7. Clustering event bus</h5><img src="./Build an application using microservices and CQRS_files/image003.png" class="ibm-downsize" alt="Clustering event bus" height="435" width="894"><p class="ibm-ind-link ibm-hide"><a class="ibm-popup-link" onclick="IBMCore.common.widget.overlay.show(&#39;N101F2&#39;);return false;" href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#N101F2">View image at full size</a></p><div class="overlayrp"></div></li></ul><p>Here is how that solution is declared.</p><div class="ibm-syntax-container"><div><div id="highlighter_902202" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript comments">&lt;!-- Create an async cluster --&gt;</code></div><div class="line number2 index1 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">axon:cluster</code> <code class="htmlscript color1">id</code><code class="htmlscript plain">=</code><code class="htmlscript string">"async"</code><code class="htmlscript plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript comments">&lt;!-- The inner bean defines the actual cluster implementation to use. Here, it is</code></div><div class="line number4 index3 alt1"><code class="htmlscript comments">an asynchronous cluster. --&gt;</code></div><div class="line number5 index4 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">bean</code> <code class="htmlscript color1">class</code><code class="htmlscript plain">=</code><code class="htmlscript string">"org.axonframework.eventhandling.async.AsynchronousCluster"</code><code class="htmlscript plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">constructor-arg</code> <code class="htmlscript color1">value</code><code class="htmlscript plain">=</code><code class="htmlscript string">"async"</code><code class="htmlscript plain">/&gt;</code></div><div class="line number7 index6 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">constructor-arg</code> <code class="htmlscript color1">ref</code><code class="htmlscript plain">=</code><code class="htmlscript string">"asyncExecutor"</code><code class="htmlscript plain">/&gt;</code></div><div class="line number8 index7 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">constructor-arg</code><code class="htmlscript plain">&gt;</code></div><div class="line number9 index8 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">bean</code> <code class="htmlscript color1">class</code><code class="htmlscript plain">=</code><code class="htmlscript string">"org.axonframework.eventhandling.async.FullConcurrencyPolicy"</code><code class="htmlscript plain">/&gt;</code></div><div class="line number10 index9 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;/</code><code class="htmlscript keyword">constructor-arg</code><code class="htmlscript plain">&gt;</code></div><div class="line number11 index10 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;/</code><code class="htmlscript keyword">bean</code><code class="htmlscript plain">&gt;</code></div><div class="line number12 index11 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript comments">&lt;!-- Here, we define which handlers we want to be part of this cluster. --&gt;</code></div><div class="line number13 index12 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">axon:selectors</code><code class="htmlscript plain">&gt;</code></div><div class="line number14 index13 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">axon:package</code> <code class="htmlscript color1">prefix</code><code class="htmlscript plain">=</code><code class="htmlscript string">"cqrs.example.shoppingcart.eventhandler"</code><code class="htmlscript plain">/&gt;</code></div><div class="line number15 index14 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;/</code><code class="htmlscript keyword">axon:selectors</code><code class="htmlscript plain">&gt;</code></div><div class="line number16 index15 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;/</code><code class="htmlscript keyword">axon:cluster</code><code class="htmlscript plain">&gt;</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript comments">&lt;!-- We also create a simple cluster and we define it as default, meaning it will</code></div><div class="line number19 index18 alt2"><code class="htmlscript comments">be selected when no other selectors (or clusters) match. --&gt;</code></div><div class="line number20 index19 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">axon:cluster</code> <code class="htmlscript color1">id</code><code class="htmlscript plain">=</code><code class="htmlscript string">"simple"</code> <code class="htmlscript color1">default</code><code class="htmlscript plain">=</code><code class="htmlscript string">"true"</code><code class="htmlscript plain">/&gt;</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript comments">&lt;!-- We need a thread pool to execute tasks. --&gt;</code></div><div class="line number23 index22 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">bean</code> <code class="htmlscript color1">id</code><code class="htmlscript plain">=</code><code class="htmlscript string">"asyncExecutor"</code> <code class="htmlscript color1">class</code><code class="htmlscript plain">=</code><code class="htmlscript string">"org.springframework.scheduling.concurrent.ThreadPoolExecutorFactoryBean"</code><code class="htmlscript plain">&gt;</code></div><div class="line number24 index23 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">property</code> <code class="htmlscript color1">name</code><code class="htmlscript plain">=</code><code class="htmlscript string">"corePoolSize"</code> <code class="htmlscript color1">value</code><code class="htmlscript plain">=</code><code class="htmlscript string">"1"</code><code class="htmlscript plain">/&gt;</code></div><div class="line number25 index24 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">property</code> <code class="htmlscript color1">name</code><code class="htmlscript plain">=</code><code class="htmlscript string">"waitForTasksToCompleteOnShutdown"</code> <code class="htmlscript color1">value</code><code class="htmlscript plain">=</code><code class="htmlscript string">"true"</code><code class="htmlscript plain">/&gt;</code></div><div class="line number26 index25 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;/</code><code class="htmlscript keyword">bean</code><code class="htmlscript plain">&gt;</code></div></div></td></tr></tbody></table></div></div></div><p>Note the declaration of selectors. These allow you to select the
                cluster to associate the listeners to. (All the listeners in the package
                <code>cqrs.example.shoppingcart.eventhandler</code> are processed with the
                cluster named "async." All the other listeners are processed with the
                cluster named "simple," which is the default.)</p><p><code>ClusteringEventBus</code> can define an <code>EventBusTerminal</code> as well.
                That way, you can distribute events to transmit events to an <span data-widget="tooltip" class="tipso_style">AMQP</span>-compatible message broker, such as Rabbit MQ. I have used this
                capability in one of my application configurations (with only configuration
                and without code changes). See "<a href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#12.2.BluemixContainerdeployment|outline">Bluemix Container
                    deployment</a>" for the deployment of this solution.</p><h2 id="10STEP7ChooseEventSerializationoutline" class="ibm-h2">Step 7. Choose event
                serialization</h2><p>It is possible to specify the type of serialization that can be in XML
                format, such as that shown in the example, or JSON format (using
                <code>org.axonframework.serializer.json.JacksonSerializer</code>), Java
                object serialization.</p><p>The serializer is used by the event store to serialize and deserialize
                event objects.</p><div class="ibm-syntax-container"><div><div id="highlighter_238208" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">bean</code> <code class="htmlscript color1">id</code><code class="htmlscript plain">=</code><code class="htmlscript string">"eventSerializer"</code> <code class="htmlscript color1">class</code><code class="htmlscript plain">=</code><code class="htmlscript string">"org.axonframework.serializer.xml.XStreamSerializer"</code><code class="htmlscript plain">/&gt;</code></div></div></td></tr></tbody></table></div></div></div><h2 id="11STEP8Interactwithapplicationoutline" class="ibm-h2">Step 8. Interact with the 
                application</h2><p>To interact with a service, you can implement REST services, separating the
                command service (HTTP Put Request) from the query services (HTTP Get
                Request). I have created a front-end web application to activate the
                services, as shown in Figure 8.</p><h5 id="N1022B" class="ibm-h5">Figure 8. Shopping cart front end</h5><img src="./Build an application using microservices and CQRS_files/image004.png" class="ibm-downsize" alt="Shopping cart front end" height="740" width="1045"><p class="ibm-ind-link"><a class="ibm-popup-link" onclick="IBMCore.common.widget.overlay.show(&#39;N1022E&#39;);return false;" href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#N1022E">View image at full size</a></p><div class="overlayrp"></div><p>The user interface interacts through a servlet, in which the commands are
                dispatched by a <code>CommandGateway</code>:</p><div class="ibm-syntax-container"><div><div id="highlighter_314090" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">……</code></div><div class="line number2 index1 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">private ApplicationContext ac; </code></div><div class="line number3 index2 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">private CommandGateway commandGateway;</code></div><div class="line number4 index3 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number5 index4 alt2"><code class="htmlscript spaces">&nbsp;</code>&nbsp;</div><div class="line number6 index5 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">/**</code></div><div class="line number7 index6 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">* @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)</code></div><div class="line number8 index7 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">*/</code></div><div class="line number9 index8 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;</code>&nbsp;</div><div class="line number10 index9 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">@Override</code></div><div class="line number11 index10 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {</code></div><div class="line number12 index11 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">response.setContentType("text/html");</code></div><div class="line number13 index12 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">String itemId=request.getParameter("id");</code></div><div class="line number14 index13 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">Integer quantity=Integer.parseInt(request.getParameter("quantity"));</code></div><div class="line number15 index14 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">AddItemCommand addItemCommand=new AddItemCommand(itemId);</code></div><div class="line number16 index15 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">addItemCommand.setQuantity(quantity);</code></div><div class="line number17 index16 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number18 index17 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">logger.debug("quantity:" + quantity);</code></div><div class="line number19 index18 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">logger.debug("id:" + itemId);</code></div><div class="line number20 index19 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">CommandCallback commandCallback = new CommandCallback&lt;</code><code class="htmlscript keyword">Object</code><code class="htmlscript plain">&gt;() {</code></div><div class="line number21 index20 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">@Override</code></div><div class="line number22 index21 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">public void onSuccess(Object result) {</code></div><div class="line number23 index22 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">logger.debug("Expected this command to fail");</code></div><div class="line number24 index23 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">}</code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">@Override</code></div><div class="line number27 index26 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">public void onFailure(Throwable cause) {</code></div><div class="line number28 index27 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">logger.debug("command exception", cause.getMessage());</code></div><div class="line number29 index28 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">}</code></div><div class="line number30 index29 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">};</code></div><div class="line number31 index30 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">//asynchronous call – with command callback</code></div><div class="line number32 index31 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">commandGateway.send(addItemCommand, commandCallback);</code></div><div class="line number33 index32 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">}</code></div><div class="line number34 index33 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number35 index34 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">@Override</code></div><div class="line number36 index35 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">public void init(ServletConfig config) throws ServletException {</code></div><div class="line number37 index36 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">super.init(config);</code></div><div class="line number38 index37 alt1">&nbsp;</div><div class="line number39 index38 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">ac = new ClassPathXmlApplicationContext("/axon-db2-configuration.xml");</code></div><div class="line number40 index39 alt1">&nbsp;</div><div class="line number41 index40 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">commandGateway= ac.getBean(CommandGateway.class);</code></div><div class="line number42 index41 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number43 index42 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">}</code></div><div class="line number44 index43 alt1"><code class="htmlscript plain">…..</code></div></div></td></tr></tbody></table></div></div></div><p>In the servlet initialization, I load the configuration of all Axon
                components, contained in a Spring configuration file.</p><p>In addition, you might note that the commands are dispatched through the
                command gateway. In the example, I send an <code>AddItemCommand</code> in
                an asynchronous way, without waiting for the process to end. I have
                registered a command callback to be notified of an eventual exception. This
                allows the system to notify the user if the real availability in stock is
                less than the quantity requested. (This might happen if another user adds
                the item to his own shopping cart while the first user is consulting the
                catalog.)</p><h2 id="12STEP9TheDeploymentoutline" class="ibm-h2">Step 9. The deployment</h2><p>An application built with microservices allows you to choose different
                deployment solutions. You are often forced to deploy monolithic
                applications on dedicated machines. In the case of microservices, however,
                the deployment can be accomplished either on the same machine or
                distributed among several machines, depending on such requirements as
                performance, security, and scalability. Considering that the Axon Framework
                gives you the ability to change the configuration without changing any
                lines of code (other than the Spring file), along with the loose coupling
                of application components, you can see how many degrees of freedom you
                have for the application deployment. Each of the application
                components—command bus, event bus, event repository, command handling,
                event handling, and so on—can be hosted on a different combination of
                machines using different technologies. In this section, I show
                you a few of them.</p><h3 id="12.1.BluemixPaaSDeployment|outline" class="ibm-h3">Bluemix PaaS deployment</h3><p>In deploying my application on Bluemix, the packaging consists of:</p><ul class="ibm-bullet-list"><li>A component for command handling—update requests (HTTP POSTs).</li><li>A component for query handling—view requests, separate from command
                    services (HTTP GETs).</li><li>A component for event handling—contains the event listeners.</li></ul><p>The application binds two Bluemix services (DB2 and MongoDB) for
                persistence of command data and event sourcing.</p><p>Figure 9 shows a possible deployment as a single application.
                This solution could be used for simplifying deployment and
                testing.</p><h5 id="N10268" class="ibm-h5">Figure 9. Deployment as a single macro
                    component</h5><img src="./Build an application using microservices and CQRS_files/single_app.png" class="ibm-downsize" alt="Figure showing single macro deployment" height="510" width="881"><p class="ibm-ind-link ibm-hide"><a class="ibm-popup-link" onclick="IBMCore.common.widget.overlay.show(&#39;N1026B&#39;);return false;" href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#N1026B">View image at full size</a></p><div class="overlayrp"></div><p> In Figure 10, I split the application into seven macro components, which
                allows me to provide the right resource level to each one. (For each of
                them, I could
                choose the number of VMs, the application language, the
                database service, and so on). Each of the macros can be deployed as a
                WAR file on an application server.</p><h5 id="N10273" class="ibm-h5">Figure 10. Deployment in macro components</h5><img src="./Build an application using microservices and CQRS_files/seven_macros.png" class="ibm-downsize" alt="Figure showing seven macro components" height="633" width="887"><p class="ibm-ind-link ibm-hide"><a class="ibm-popup-link" onclick="IBMCore.common.widget.overlay.show(&#39;N10276&#39;);return false;" href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#N10276">View image at full size</a></p><div class="overlayrp"></div><p>Currently on Bluemix, I have deployed a halfway solution, using WebSphere
                Application Server 
                Liberty for the application server, I have installed two web applications:
                one for the front end, command handling, and query handling, and another for
                event handling.</p><h5 id="N1027E" class="ibm-h5">Figure 11. Deployment on Bluemix</h5><img src="./Build an application using microservices and CQRS_files/halfway.png" class="ibm-downsize" alt="Deployment on Bluemix" height="548" width="819"><p class="ibm-ind-link ibm-hide"><a class="ibm-popup-link" onclick="IBMCore.common.widget.overlay.show(&#39;N10281&#39;);return false;" href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#N10281">View image at full size</a></p><div class="overlayrp"></div><p> For this solution, I only have to package the application in a different
                way (I have two WAR files), but all the code is unchanged.</p><h3 id="12.2.BluemixContainerdeployment|outline" class="ibm-h3">Bluemix container deployment</h3><p>Another possibility is to deploy using Bluemix containers. </p><p>By changing only the Spring configuration file (and not the
                application code), you can change the deployment scheme. I believe 
                this ability to adapt to the available environment is the most exciting
                characteristic of this pattern. In this case, I have used MongoDB for
                the event store and Rabbit-MQ for the event bus. Figure 12 shows how I
                organize the containers to host the application components.</p><h5 id="N10292" class="ibm-h5">Figure 12. Deployment with Bluemix
                    containers</h5><img src="./Build an application using microservices and CQRS_files/containers.png" class="ibm-downsize" alt="Deployment with Bluemix containers" height="476" width="986"><p class="ibm-ind-link"><a class="ibm-popup-link" onclick="IBMCore.common.widget.overlay.show(&#39;N10295&#39;);return false;" href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#N10295">View image at full size</a></p><div class="overlayrp"></div><p>If this is your first time working with containers, log in to the Bluemix
                console and select <strong>Add your own</strong>.</p><h5 id="N102A0" class="ibm-h5">Figure 13. Console of a Bluemix container</h5><img src="./Build an application using microservices and CQRS_files/image005.png" class="ibm-downsize" alt="Console of a Bluemix container" height="387" width="1160"><p class="ibm-ind-link"><a class="ibm-popup-link" onclick="IBMCore.common.widget.overlay.show(&#39;N102A3&#39;);return false;" href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#N102A3">View image at full size</a></p><div class="overlayrp"></div><p>The first time you do this, you must set a name for the namespace that is
                associated with your private Bluemix repository. The namespace is used to
                generate a unique URL. Then you will receive all the instructions to
                access the Bluemix container space.</p><p>For a complete guide to managing the Docker container on Bluemix, see: "<a href="https://console.ng.bluemix.net/docs/containers/container_cli_cfic.html">IBM Containers plug-in (cf ic)</a>."</p><p>You need the Cloud Foundry CLI. To install the Bluemix Docker plugin (I installed it
                on my Ubuntu installation), enter the following:</p><div class="ibm-syntax-container"><div><div id="highlighter_43671" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">./cf install-plugin https://static-ice.ng.bluemix.net/ibm-containers-linux_x64</code></div><div class="line number2 index1 alt1"><code class="htmlscript plain">/cf install-plugin https://static-ice.ng.bluemix.net/ibm-containers-linux_x64</code></div></div></td></tr></tbody></table></div></div></div><p>Log in to your Bluemix space and then to the Bluemix container space, and
                then enter:</p><div class="ibm-syntax-container"><div><div id="highlighter_972281" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">./cf ic login</code></div></div></td></tr></tbody></table></div></div></div><p>Now you can act on your private registry, adding the images that the
                application needs. In addition to the application's source code, the code
                I have provided contains Docker files for creating and configuring Docker
                images.</p><h2 id="13Conclusionoutline" class="ibm-h2">Conclusion</h2><p>This article has described a way of designing highly scalable and available
                applications that are based on microservices built with polyglot
                persistence, event sourcing, and the CQRS pattern. By using the Axon
                Framework, you can focus on the
                business domain and write code that is ready for various configuration
                deployments, which hides the infrastructural complexity and makes the coding
                relatively easy. In fact, regardless of the complexity of the business
                logic, with these techniques the implementation of new commands, events,
                and event listeners can become essentially a purely mechanical and
                repetitive process.</p><!--CMA ID: 1034486--><!--Site ID: 1--><!--XSLT stylesheet used to transform this file: dw-document-html-8.0.xsl--> 
                                        <!-- Article Resources -->
                                        <div class="ibm-alternate-rule"><hr></div><h4 id="artdownload" class="ibm-h4">Downloadable resources</h4><ul class="ibm-link-list"><li><a class="ibm-pdf-link" href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/cl-build-app-using-microservices-and-cqrs-trs-pdf.pdf">PDF</a></li></ul><div class="ibm-alternate-rule"><hr></div><h4 id="artrelatedtopics" class="ibm-h4">Related topics</h4><ul class="ibm-plain-list"><li><a href="http://martinfowler.com/bliki/CQRS.html">Martin Fowler on CQRS</a></li><li><a href="https://www.ibm.com/developerworks/cloud/library/cl-get-the-most-out-of-cloud-1-trs/index.html">Cloud solutions vs traditional web apps</a></li><li><a href="http://www.axonframework.org/">Axon Framework</a></li><li><a href="https://spring.io/">Spring</a></li><li><a href="https://console.ng.bluemix.net/docs/containers/container_cli_cfic.html">IBM Containers plug-in (cf ic) documentation</a></li></ul>
                                        <!-- Commenting -->
<!-- INLINE_COMMENTS_BEGIN: -->
<div class="ibm-alternate-rule"><hr></div>
<div id="dw-article-cmts-top" class="ibm-columns">
    <div class="ibm-col-6-2">
        <h4 id="icomments" class="ibm-h4">Comments</h4>
        <div id="dw-article-cmts-login">
            <p><a onclick="window.location=userLinks[0].url;" tabindex="0" role="link">Sign in</a> or 
                <a onclick="window.location=userLinks[1].url;" tabindex="0" role="link">register</a> to add and subscribe to comments.</p>
        </div>
    </div>    
    <div class="ibm-col-6-2" id="dw-notify"> 
        <input type="checkbox" value="1" name="comment_notification" id="comment_notification" disabled="">
        <label for="comment_notification" style="color: rgb(204, 204, 204);">Subscribe me to comment notifications</label>	   
    </div>
</div>

<div class="dw-article-cmts-container">       
    <div class="ibm-no-print jquery-comments read-only" id="dw-icomments-container"><div class="commenting-field main"><img src="./Build an application using microservices and CQRS_files/user-icon.png" alt="" class="profile-picture round by-current-user"><div class="textarea-wrapper"><span class="close" style="display: none;"><span class="left"></span><span class="right"></span></span><div class="textarea" data-placeholder="Add a comment" contenteditable="true" style="height: 3.65em;"></div><div class="control-row" style="display: none;"><span class="send save highlight-background">Submit</span></div></div></div><ul class="navigation"><div class="navigation-wrapper"><li data-sort-key="newest" data-container-name="comments" class="active">Newest</li><li data-sort-key="oldest" data-container-name="comments">Oldest</li><li data-sort-key="popularity" data-container-name="comments">Popular</li></div><div class="navigation-wrapper responsive"><li class="title active"><header>Newest</header></li><ul class="dropdown"><li data-sort-key="newest" data-container-name="comments" class="active">Newest</li><li data-sort-key="oldest" data-container-name="comments">Oldest</li><li data-sort-key="popularity" data-container-name="comments">Popular</li></ul></div></ul><div class="data-container" data-container="comments"><ul id="comment-list" class="main"><li data-id="25339" class="comment"><div class="comment-wrapper"><img src="./Build an application using microservices and CQRS_files/user-icon.png" alt="" class="profile-picture round"><time data-original="1469822884121">29 Jul 2016</time><div class="name"><a href="https://www.ibm.com/developerworks/community/profiles/user/MarcoAntonioni">MarcoAntonioni</a></div><div class="wrapper"><div class="content">an article really well done</div><span class="actions"><button class="action reply" type="button">Reply</button><span class="separator">·</span><button class="action upvote"><span class="upvote-count">3</span><i class="fa fa-thumbs-up"></i></button><span class="separator">·</span><a class="action reply" href="https://www.ibm.com/developerworks/community/report?lang=en&amp;referingURL=https%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fcloud%2Flibrary%2Fcl-build-app-using-microservices-and-cqrs-trs%2F&amp;mymessage=Comment%3A%20an%20article%20really%20well%20done%0DPosted%20by%20MarcoAntonioni%20on%2029%20Jul%202016%0D%0D---%20Add%20any%20comments%20below%20this%20line%20---" target="_blank">Report Abuse<i class="fa image" style="background-image: url(&quot;/developerworks/maverick/image/report-abuse.png&quot;);"></i></a></span></div></div><ul class="child-comments"></ul></li></ul><div class="no-comments no-data"><i class="fa fa-comments fa-2x"></i><br>Be the first to add a comment</div></div></div>
</div>
<!-- INLINE_COMMENTS_END -->                                        <!-- CENTER_6_4_CONTENT_COLUMN_END -->
                                    </div>   
                                </div>
                        <!--Rating_Meta_BEGIN--><div class="metavalue">static.content.url=http://www.ibm.com/developerworks/js/artrating/</div><div class="metavalue">SITE_ID=1</div><div class="metavalue">Zone=Cloud computing</div><div class="metavalue">ArticleID=1034486</div><div class="metavalue">ArticleTitle=Build an application using microservices and CQRS</div><div class="metavalue">publish-date=07272016</div><script language="javascript" type="text/javascript">document.write('<div class="metavalue">url='+location.href.replace(/</g,  '%3C')+'</div>');</script><div class="metavalue">url=https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/</div><!--Rating_Meta_END-->
                    </div>
                    <!-- END_IBM-CONTENT-MAIN -->
                <p class="ibm-ind-link ibm-nospacing ibm-icononly ibm-btt-auto ibm-hidden-small"><a class="ibm-nospacing ibm-chevron-up-link" href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#top" tabindex="-1">Back to top</a></p></div>
                <!-- END_IBM-CONTENT-BODY -->
            </div>
            <!-- END_IBM-CONTENT -->
        </div>
        <!-- END_IBM-PCON -->
    </main>
    <!-- MAIN_CONTENT_END -->
    
    <!-- END_CONTENT-WRAPPER -->	
</div>
<!-- FOOTER_BEGIN -->
<footer role="contentinfo" aria-label="IBM developerWorks">
    <div id="dw-footer-module">
        <section aria-label="Resources" role="contentinfo">
            <div class="ibm-columns">
                <div class="ibm-col-6-1 dw-footer-col-1">
                    <ul class="dw-footer-site-links">
                        <li class="dw-footer-heading" aria-label="developerWorks">developerWorks</li>
                        <li><a href="https://www.ibm.com/developerworks/aboutdw/">About</a></li>
                        <li><a href="https://www.ibm.com/developerworks/feedback">Help</a></li>
                        <li class="dw-footer-newline"><a href="https://www.ibm.com/developerworks/ideas">Submit content</a></li>
                        <li class="dw-footer-newline"><a href="https://www.ibm.com/developerworks/rfe/">RFE Community</a></li>
                        <li class="dw-footer-newline"><a href="https://www.ibm.com/developerworks/community/report/">Report abuse</a></li>
                        <li class="dw-footer-newline"><a href="https://www.ibm.com/developerworks/community/terms/thirdparty/">Third-party notice</a></li>
                    </ul>
                    <p class="dw-footer-social">
                        <a href="https://twitter.com/developerWorks">
                            <img width="28" height="27" alt="Twitter" src="./Build an application using microservices and CQRS_files/dw-footer-icon-twitter.png">
                        </a>
                    </p>
                    <p class="dw-footer-social-right">
                        <a href="https://www.facebook.com/developerworks">
                            <img width="28" height="27" alt="Facebook" src="./Build an application using microservices and CQRS_files/dw-footer-icon-facebook.png">
                        </a>
                    </p>
                    <br>
                    <p class="dw-footer-social">
                        <a href="https://www.linkedin.com/groups/IBM-developerWorks-8137234">
                            <img width="28" height="27" alt="LinkedIn" src="./Build an application using microservices and CQRS_files/dw-footer-icon-linkedin.png">
                        </a>
                    </p>
                    <p class="dw-footer-social-right">
                        <a href="https://www.youtube.com/user/developerworks">
                            <img width="28" height="27" alt="YouTube" src="./Build an application using microservices and CQRS_files/dw-footer-icon-youtube.png">
                        </a>
                    </p>
                    <br>
                    <p class="dw-footer-social">
                        <a href="https://plus.google.com/108822932610995774195/posts?partnerid=gplp0">
                            <img width="28" height="27" alt="Google+" src="./Build an application using microservices and CQRS_files/dw-footer-icon-googleplus.png">
                        </a>
                    </p>
                </div>
                <div class="ibm-col-6-1 dw-footer-col-2">
                    <ul>
                        <li class="dw-footer-heading" aria-label="Join">Join</li>
                        <li><a href="https://developer.ibm.com/academic/">Faculty</a></li>
                        <li><a href="https://developer.ibm.com/students/">Students</a></li>
                        <li class="dw-footer-newline"><a href="https://www.ibm.com/isv/">Business Partners</a></li>
                    </ul>
                    <ul class="dw-footer-lang" aria-label="Select a language">
                        <li class="dw-footer-heading">Select a language</li>
                        <li><a href="https://www.ibm.com/developerworks/">English</a></li>
                        <li><a href="https://www.ibm.com/developerworks/cn/" lang="zh">中文</a></li>
                        <li><a href="https://www.ibm.com/developerworks/jp/" lang="ja">日本語</a></li>
                        <li><a href="https://www.ibm.com/developerworks/ru/" lang="ru">Русский</a></li>
                        <li class="dw-footer-newline"><a href="https://www.ibm.com/developerworks/br/" lang="pt">Português (Brasil)</a></li>
                        <li><a href="https://www.ibm.com/developerworks/ssa/" lang="es">Español</a></li>
                        <li><a href="https://developer.ibm.com/kr/" lang="kr">한글</a></li>
                    </ul>
                </div>
                <div class="ibm-col-6-1 dw-footer-col-3"> </div>
                <div class="ibm-col-6-1 dw-footer-col-4">
                    <ul class="dw-footer-categories">
                        <li class="dw-footer-category">
                            <a href="https://developer.ibm.com/events/">
                                <div class="dw-footer-content-icon-events">
                                    <img width="48" height="34" aria-hidden="true" alt="" src="./Build an application using microservices and CQRS_files/dw-footer-icon-events.png">
                                </div>
                                <p>Events</p>
                            </a>
                        </li>
                        <li class="dw-footer-category">
                            <a href="https://developer.ibm.com/tv/">
                                <div class="dw-footer-content-icon">
                                    <img width="44" height="43" aria-hidden="true" alt="" src="./Build an application using microservices and CQRS_files/dw-footer-icon-dwtv.png">
                                </div>
                                <p>dW TV</p>
                            </a>
                        </li>
                        <li class="dw-footer-category">
                            <a href="https://www.ibm.com/developerworks/feeds/">
                                <div class="dw-footer-content-icon">
                                    <img width="40" height="40" aria-hidden="true" alt="" src="./Build an application using microservices and CQRS_files/dw-footer-icon-feeds.png">
                                </div>
                                <p>Feeds</p>
                            </a>  
                        </li>
                    </ul>
                </div>
                <div class="ibm-col-6-1 dw-footer-col-5">
                    <ul class="dw-footer-categories">
                        <li class="dw-footer-category">
                            <a href="https://www.ibm.com/developerworks/newsletter/">
                                <div class="dw-footer-content-icon">
                                    <img width="33" height="50" aria-hidden="true" alt="" src="./Build an application using microservices and CQRS_files/dw-footer-icon-newsletters.png">
                                </div>
                                <p>Newsletters</p>
                            </a>  
                        </li>
                        <li class="dw-footer-category">
                            <a href="https://developer.ibm.com/answers/">
                                <div class="dw-footer-content-icon">
                                    <img width="46" height="38" aria-hidden="true" alt="" src="./Build an application using microservices and CQRS_files/dw-footer-icon-dwanswers.png">
                                </div>
                                <p>dW Answers</p>
                            </a>  
                        </li>
                        <li class="dw-footer-category">
                            <a href="https://developer.ibm.com/dwblog/">
                                <div class="dw-footer-content-icon">
                                    <img width="44" height="43" aria-hidden="true" alt="" src="./Build an application using microservices and CQRS_files/dw-footer-icon-dwblog.png">
                                </div>
                                <p>dW Blog</p>
                            </a>  
                        </li>
                    </ul>
                </div>
                <div class="ibm-col-6-1 dw-footer-col-6">
                    <ul class="dw-footer-categories">
                        <li class="dw-footer-category">
                            <a href="https://www.ibm.com/us-en/marketplace/developer-program?cm_sp=dwpremium-_-dwfooter-_-footer">
                                <div class="dw-footer-content-icon">
                                    <img width="35" height="45" aria-hidden="true" alt="" src="./Build an application using microservices and CQRS_files/dw-footer-icon-premium.png">
                                </div>
                                <p>dW Premium</p>
                            </a>  
                        </li>
                        <li class="dw-footer-category">
                            <a href="https://www.ibm.com/developerworks/develop/">
                                <div class="dw-footer-content-icon">
                                    <img width="44" height="43" aria-hidden="true" alt="" src="./Build an application using microservices and CQRS_files/dw-footer-icon-downloads.png">
                                </div>
                                <p>Downloads</p>
                            </a>  
                        </li>
                        <li class="dw-footer-category">
                            <a href="https://developer.ibm.com/courses/">
                                <div class="dw-footer-content-icon">
                                    <img width="45" height="43" aria-hidden="true" alt="" src="./Build an application using microservices and CQRS_files/dw-footer-icon-courses.png">
                                </div>
                                <p>dW Courses</p>
                            </a>  
                        </li>
                    </ul>
                </div>
            </div>
        </section>
    </div>
    <div id="dw-footer" class="ibm-padding-normal ibm-alternate">
        <div class="ibm-columns">
            <div class="ibm-col-1-1">
                <div class="dw-footer-corporate-links">
                    <ul>
                        <li><a href="https://www.ibm.com/developerworks/aboutdw/contacts.html">Contact</a></li>
                        <li><a href="https://www.ibm.com/privacy/us/en/">Privacy</a></li>
                        <li><a href="https://www.ibm.com/developerworks/community/terms/use/">Terms of use</a></li>
                        <li><a href="https://www.ibm.com/accessibility/us/en/">Accessibility</a></li>
                        <li class="ibm-feedbacklink"><a href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#">Feedback</a></li>
                        <li id="ibm-truste-cp"><a onclick="truste.eu.clickListener();return false;" href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#">Cookie Preferences</a></li>
                    </ul>                 
                </div>
                <div id="ibm-footer-locale-selector"><h3 class="ibm-bold">Select a country/region</h3><select class="ibm-fullwidth select2-hidden-accessible ibm-widget-processed" aria-label="Select a country/region" tabindex="-1" aria-hidden="true" style="width: 395px;"><optgroup label="Worldwide ibm.com home pages"><option data-localecode="en-af" value="http://www.ibm.com/af-en/?lnk=fcc">Afghanistan - English</option><option data-localecode="fr-dz" value="http://www.ibm.com/dz-fr/?lnk=fcc">Algeria - French</option><option data-localecode="pt-ao" value="http://www.ibm.com/ao-pt/?lnk=fcc">Angola - Portuguese</option><option data-localecode="en-ai" value="http://www.ibm.com/ai-en/?lnk=fcc">Anguilla - English</option><option data-localecode="en-ag" value="http://www.ibm.com/ag-en/?lnk=fcc">Antigua and Barbuda - English</option><option data-localecode="es-ar" value="http://www.ibm.com/ar-es/?lnk=fcc">Argentina - Spanish</option><option data-localecode="en-aw" value="http://www.ibm.com/aw-en/?lnk=fcc">Aruba - English</option><option data-localecode="en-au" value="http://www.ibm.com/au-en/?lnk=fcc">Australia - English</option><option data-localecode="de-at" value="http://www.ibm.com/at-de/?lnk=fcc">Austria - German</option><option data-localecode="en-bs" value="http://www.ibm.com/bs-en/?lnk=fcc">Bahamas - English</option><option data-localecode="en-bh" value="http://www.ibm.com/bh-en/?lnk=fcc">Bahrain - English</option><option data-localecode="en-bd" value="http://www.ibm.com/bd-en/?lnk=fcc">Bangladesh - English</option><option data-localecode="en-bb" value="http://www.ibm.com/bb-en/?lnk=fcc">Barbados - English</option><option data-localecode="nl-be" value="http://www.ibm.com/be-nl/?lnk=fcc">Belgium/Luxembourg - Dutch</option><option data-localecode="en-be" value="http://www.ibm.com/be-en/?lnk=fcc">Belgium/Luxembourg - English</option><option data-localecode="fr-be" value="http://www.ibm.com/be-fr/?lnk=fcc">Belgium/Luxembourg - French</option><option data-localecode="en-bm" value="http://www.ibm.com/bm-en/?lnk=fcc">Bermuda - English</option><option data-localecode="es-bo" value="http://www.ibm.com/bo-es/?lnk=fcc">Bolivia - Spanish</option><option data-localecode="en-bw" value="http://www.ibm.com/bw-en/?lnk=fcc">Botswana - English</option><option data-localecode="pt-br" value="http://www.ibm.com/br-pt/?lnk=fcc">Brazil - Portuguese</option><option data-localecode="en-bn" value="http://www.ibm.com/bn-en/?lnk=fcc">Brunei Darussalam - English</option><option data-localecode="bg-bg" value="http://www.ibm.com/bg-bg/?lnk=fcc">Bulgaria - Bulgarian</option><option data-localecode="fr-bf" value="http://www.ibm.com/bf-fr/?lnk=fcc">Burkina Faso - French</option><option data-localecode="en-kh" value="http://www.ibm.com/kh-en/?lnk=fcc">Cambodia - English</option><option data-localecode="en-cm" value="http://www.ibm.com/cm-en/?lnk=fcc">Cameroon - English</option><option data-localecode="fr-cm" value="http://www.ibm.com/cm-fr/?lnk=fcc">Cameroon - French</option><option data-localecode="en-ca" value="http://www.ibm.com/ca-en/?lnk=fcc">Canada - English</option><option data-localecode="fr-ca" value="http://www.ibm.com/ca-fr/?lnk=fcc">Canada - French</option><option data-localecode="en-ky" value="http://www.ibm.com/ky-en/?lnk=fcc">Cayman Islands - English</option><option data-localecode="fr-td" value="http://www.ibm.com/td-fr/?lnk=fcc">Chad - French</option><option data-localecode="es-cl" value="http://www.ibm.com/cl-es/?lnk=fcc">Chile - Spanish</option><option data-localecode="zh-cn" value="http://www.ibm.com/cn-zh/?lnk=fcc">China - Chinese (Simplified)</option><option data-localecode="es-co" value="http://www.ibm.com/co-es/?lnk=fcc">Colombia - Spanish</option><option data-localecode="fr-cg" value="http://www.ibm.com/cg-fr/?lnk=fcc">Congo - French</option><option data-localecode="fr-cd" value="http://www.ibm.com/cd-fr/?lnk=fcc">Congo, The Democratic Republic of the - French</option><option data-localecode="es-cr" value="http://www.ibm.com/cr-es/?lnk=fcc">Costa Rica - Spanish</option><option data-localecode="hr-hr" value="http://www.ibm.com/hr-hr/?lnk=fcc">Croatia - Croatian</option><option data-localecode="en-cw" value="http://www.ibm.com/cw-en/?lnk=fcc">Curacao - English</option><option data-localecode="en-cy" value="http://www.ibm.com/cy-en/?lnk=fcc">Cyprus - English</option><option data-localecode="cs-cz" value="http://www.ibm.com/cz-cs/?lnk=fcc">Czech Republic - Czech</option><option data-localecode="da-dk" value="http://www.ibm.com/dk-da/?lnk=fcc">Denmark - Danish</option><option data-localecode="en-dm" value="http://www.ibm.com/dm-en/?lnk=fcc">Dominica - English</option><option data-localecode="es-ec" value="http://www.ibm.com/ec-es/?lnk=fcc">Ecuador - Spanish</option><option data-localecode="en-eg" value="http://www.ibm.com/eg-en/?lnk=fcc">Egypt - English</option><option data-localecode="et-ee" value="http://www.ibm.com/ee-et/?lnk=fcc">Estonia - Estonian</option><option data-localecode="en-et" value="http://www.ibm.com/et-en/?lnk=fcc">Ethiopia - English</option><option data-localecode="fi-fi" value="http://www.ibm.com/fi-fi/?lnk=fcc">Finland - Finnish</option><option data-localecode="fr-fr" value="http://www.ibm.com/fr-fr/?lnk=fcc">France - French</option><option data-localecode="fr-ga" value="http://www.ibm.com/ga-fr/?lnk=fcc">Gabon - French</option><option data-localecode="de-de" value="http://www.ibm.com/de-de/?lnk=fcc">Germany - German</option><option data-localecode="en-gh" value="http://www.ibm.com/gh-en/?lnk=fcc">Ghana - English</option><option data-localecode="el-gr" value="http://www.ibm.com/gr-el/?lnk=fcc">Greece - Greek</option><option data-localecode="en-gd" value="http://www.ibm.com/gd-en/?lnk=fcc">Grenada - English</option><option data-localecode="en-gy" value="http://www.ibm.com/gy-en/?lnk=fcc">Guyana - English</option><option data-localecode="en-hk" value="http://www.ibm.com/hk-en/?lnk=fcc">Hong Kong - English</option><option data-localecode="hu-hu" value="http://www.ibm.com/hu-hu/?lnk=fcc">Hungary - Hungarian</option><option data-localecode="en-in" value="http://www.ibm.com/in-en/?lnk=fcc">India - English</option><option data-localecode="en-id" value="http://www.ibm.com/id-en/?lnk=fcc">Indonesia - English</option><option data-localecode="en-iq" value="http://www.ibm.com/iq-en/?lnk=fcc">Iraq - English</option><option data-localecode="en-ie" value="http://www.ibm.com/ie-en/?lnk=fcc">Ireland - English</option><option data-localecode="he-il" value="http://www.ibm.com/il-he/?lnk=fcc">Israel - Hebrew</option><option data-localecode="it-it" value="http://www.ibm.com/it-it/?lnk=fcc">Italy - Italian</option><option data-localecode="fr-ci" value="http://www.ibm.com/ci-fr/?lnk=fcc">Ivory Coast - French</option><option data-localecode="en-jm" value="http://www.ibm.com/jm-en/?lnk=fcc">Jamaica - English</option><option data-localecode="ja-jp" value="http://www.ibm.com/jp-ja/?lnk=fcc">Japan - Japanese</option><option data-localecode="en-jo" value="http://www.ibm.com/jo-en/?lnk=fcc">Jordan - English</option><option data-localecode="kk-kz" value="http://www.ibm.com/kz-kk/?lnk=fcc">Kazakhstan - Kazakh</option><option data-localecode="en-ke" value="http://www.ibm.com/ke-en/?lnk=fcc">Kenya - English</option><option data-localecode="ko-kr" value="http://www.ibm.com/kr-ko/?lnk=fcc">Korea, Republic of - Korean</option><option data-localecode="en-kw" value="http://www.ibm.com/kw-en/?lnk=fcc">Kuwait - English</option><option data-localecode="lv-lv" value="http://www.ibm.com/lv-lv/?lnk=fcc">Latvia - Latvian</option><option data-localecode="en-lb" value="http://www.ibm.com/lb-en/?lnk=fcc">Lebanon - English</option><option data-localecode="en-ly" value="http://www.ibm.com/ly-en/?lnk=fcc">Libya - English</option><option data-localecode="lt-lt" value="http://www.ibm.com/lt-lt/?lnk=fcc">Lithuania - Lithuanian</option><option data-localecode="fr-mg" value="http://www.ibm.com/mg-fr/?lnk=fcc">Madagascar - French</option><option data-localecode="en-mw" value="http://www.ibm.com/mw-en/?lnk=fcc">Malawi - English</option><option data-localecode="en-my" value="http://www.ibm.com/my-en/?lnk=fcc">Malaysia - English</option><option data-localecode="en-mu" value="http://www.ibm.com/mu-en/?lnk=fcc">Mauritius - English</option><option data-localecode="fr-mu" value="http://www.ibm.com/mu-fr/?lnk=fcc">Mauritius - French</option><option data-localecode="es-mx" value="http://www.ibm.com/mx-es/?lnk=fcc">Mexico - Spanish</option><option data-localecode="en-ms" value="http://www.ibm.com/ms-en/?lnk=fcc">Montserrat - English</option><option data-localecode="fr-ma" value="http://www.ibm.com/ma-fr/?lnk=fcc">Morocco - French</option><option data-localecode="pt-mz" value="http://www.ibm.com/mz-pt/?lnk=fcc">Mozambique - Portuguese</option><option data-localecode="en-na" value="http://www.ibm.com/na-en/?lnk=fcc">Namibia - English</option><option data-localecode="en-np" value="http://www.ibm.com/np-en/?lnk=fcc">Nepal - English</option><option data-localecode="nl-nl" value="http://www.ibm.com/nl-nl/?lnk=fcc">Netherlands - Dutch</option><option data-localecode="en-nz" value="http://www.ibm.com/nz-en/?lnk=fcc">New Zealand - English</option><option data-localecode="fr-ne" value="http://www.ibm.com/ne-fr/?lnk=fcc">Niger - French</option><option data-localecode="en-ng" value="http://www.ibm.com/ng-en/?lnk=fcc">Nigeria - English</option><option data-localecode="no-no" value="http://www.ibm.com/no-no/?lnk=fcc">Norway - Norwegian</option><option data-localecode="en-om" value="http://www.ibm.com/om-en/?lnk=fcc">Oman - English</option><option data-localecode="en-pk" value="http://www.ibm.com/pk-en/?lnk=fcc">Pakistan - English</option><option data-localecode="es-py" value="http://www.ibm.com/py-es/?lnk=fcc">Paraguay - Spanish</option><option data-localecode="es-pe" value="http://www.ibm.com/pe-es/?lnk=fcc">Peru - Spanish</option><option data-localecode="en-ph" value="http://www.ibm.com/ph-en/?lnk=fcc">Philippines - English</option><option data-localecode="pl-pl" value="http://www.ibm.com/pl-pl/?lnk=fcc">Poland - Polish</option><option data-localecode="pt-pt" value="http://www.ibm.com/pt-pt/?lnk=fcc">Portugal - Portuguese</option><option data-localecode="en-qa" value="http://www.ibm.com/qa-en/?lnk=fcc">Qatar - English</option><option data-localecode="ro-ro" value="http://www.ibm.com/ro-ro/?lnk=fcc">Romania - Romanian</option><option data-localecode="ru-ru" value="http://www.ibm.com/ru-ru/?lnk=fcc">Russian Federation - Russian</option><option data-localecode="en-kn" value="http://www.ibm.com/kn-en/?lnk=fcc">Saint Kitts and Nevis - English</option><option data-localecode="en-lc" value="http://www.ibm.com/lc-en/?lnk=fcc">Saint Lucia - English</option><option data-localecode="en-vc" value="http://www.ibm.com/vc-en/?lnk=fcc">Saint Vincent and the Grenadines - English</option><option data-localecode="en-sa" value="http://www.ibm.com/sa-en/?lnk=fcc">Saudi Arabia - English</option><option data-localecode="fr-sn" value="http://www.ibm.com/sn-fr/?lnk=fcc">Senegal - French</option><option data-localecode="sr-rs" value="http://www.ibm.com/rs-sr/?lnk=fcc">Serbia - Serbian</option><option data-localecode="fr-sc" value="http://www.ibm.com/sc-fr/?lnk=fcc">Seychelles - French</option><option data-localecode="en-sl" value="http://www.ibm.com/sl-en/?lnk=fcc">Sierra Leone - English</option><option data-localecode="en-sg" value="http://www.ibm.com/sg-en/?lnk=fcc">Singapore - English</option><option data-localecode="sk-sk" value="http://www.ibm.com/sk-sk/?lnk=fcc">Slovakia - Slovak</option><option data-localecode="sl-si" value="http://www.ibm.com/si-sl/?lnk=fcc">Slovenia - Slovenian</option><option data-localecode="en-za" value="http://www.ibm.com/za-en/?lnk=fcc">South Africa - English</option><option data-localecode="es-es" value="http://www.ibm.com/es-es/?lnk=fcc">Spain - Spanish</option><option data-localecode="en-lk" value="http://www.ibm.com/lk-en/?lnk=fcc">Sri Lanka - English</option><option data-localecode="en-sr" value="http://www.ibm.com/sr-en/?lnk=fcc">Suriname - English</option><option data-localecode="sv-se" value="http://www.ibm.com/se-sv/?lnk=fcc">Sweden - Swedish</option><option data-localecode="fr-ch" value="http://www.ibm.com/ch-fr/?lnk=fcc">Switzerland - French</option><option data-localecode="de-ch" value="http://www.ibm.com/ch-de/?lnk=fcc">Switzerland - German</option><option data-localecode="zh-tw" value="http://www.ibm.com/tw-zh/?lnk=fcc">Taiwan - Chinese (Traditional)</option><option data-localecode="en-tz" value="http://www.ibm.com/tz-en/?lnk=fcc">Tanzania, United Republic of - English</option><option data-localecode="en-th" value="http://www.ibm.com/th-en/?lnk=fcc">Thailand - English</option><option data-localecode="en-tt" value="http://www.ibm.com/tt-en/?lnk=fcc">Trinidad and Tobago - English</option><option data-localecode="fr-tn" value="http://www.ibm.com/tn-fr/?lnk=fcc">Tunisia - French</option><option data-localecode="tr-tr" value="http://www.ibm.com/tr-tr/?lnk=fcc">Turkey - Turkish</option><option data-localecode="en-tc" value="http://www.ibm.com/tc-en/?lnk=fcc">Turks and Caicos Islands - English</option><option data-localecode="en-ug" value="http://www.ibm.com/ug-en/?lnk=fcc">Uganda - English</option><option data-localecode="uk-ua" value="http://www.ibm.com/ua-uk/?lnk=fcc">Ukraine - Ukrainian</option><option data-localecode="en-ae" value="http://www.ibm.com/ae-en/?lnk=fcc">United Arab Emirates - English</option><option data-localecode="en-uk" value="http://www.ibm.com/uk-en/?lnk=fcc">United Kingdom - English</option><option data-localecode="en-us" value="http://www.ibm.com/us-en/?lnk=fcc" selected="selected">United States - English</option><option data-localecode="es-uy" value="http://www.ibm.com/uy-es/?lnk=fcc">Uruguay - Spanish</option><option data-localecode="uz-uz" value="http://www.ibm.com/uz-uz/?lnk=fcc">Uzbekistan - Uzbek</option><option data-localecode="es-ve" value="http://www.ibm.com/ve-es/?lnk=fcc">Venezuela - Spanish</option><option data-localecode="en-vn" value="http://www.ibm.com/vn-en/?lnk=fcc">Vietnam - English</option><option data-localecode="vi-vn" value="http://www.ibm.com/vn-vi/?lnk=fcc">Vietnam - Vietnamese</option><option data-localecode="en-vg" value="http://www.ibm.com/vg-en/?lnk=fcc">Virgin Islands, British - English</option><option data-localecode="en-ye" value="http://www.ibm.com/ye-en/?lnk=fcc">Yemen - English</option><option data-localecode="en-zm" value="http://www.ibm.com/zm-en/?lnk=fcc">Zambia - English</option><option data-localecode="en-zw" value="http://www.ibm.com/zw-en/?lnk=fcc">Zimbabwe - English</option></optgroup></select><span class="select2 select2-container select2-container--default" dir="ltr" style="width: 100%;"><span class="selection"><span class="select2-selection select2-selection--single" role="combobox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-labelledby="select2-bh0e-container"><span class="select2-selection__rendered" id="select2-bh0e-container" title="United States - English">United States - English</span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span></span></span><span class="dropdown-wrapper" aria-hidden="true"></span></span></div>
            </div>
        </div>
    </div>        
</footer> <!-- FOOTER_END -->

<!-- END_IBM-TOP -->
</div>

<!-- SCRIPTS_INCLUDE_BEGIN -->
<!-- Styles -->
<link rel="stylesheet" type="text/css" href="./Build an application using microservices and CQRS_files/jquery-comments.css">
<link rel="stylesheet" href="./Build an application using microservices and CQRS_files/font-awesome.min.css">

<!-- Libraries -->
<script type="text/javascript" src="./Build an application using microservices and CQRS_files/jquery-comments.min.js.download"></script>
<script type="text/javascript" src="./Build an application using microservices and CQRS_files/moment-with-locales.js.download"></script>
<script type="text/javascript" src="./Build an application using microservices and CQRS_files/ContentComments.js.download"></script>
<script type="text/javascript" src="./Build an application using microservices and CQRS_files/ContentCommentsFormatter.js.download"></script>
<script type="text/javascript" language="JavaScript">

	IBMCore.common.module.masthead.subscribe("ready", "customjs", setupCommentsPlugin).runAsap(setupCommentsPlugin);

	function setupCommentsPlugin(){
		//debugger;
			//alert(userLinks);
			var commentsInitInfo = {
				contentId : $("div[class=metavalue]:contains('ArticleID=')").text().split("=")[1],
				siteId :  $("div[class=metavalue]:contains('SITE_ID=')").text().split("=")[1],
				pluginDivId : '#dw-icomments-container',
				notifyElementId : "#comment_notification",
				loginMessageDivId : "#dw-article-cmts-login",
				totalCommentsDivId : "#nCmts"
			};				
								
			ContentComments.Setup(commentsInitInfo);
	}
</script>
<script type="text/javascript">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-41146412-3','auto');ga('require','linkid','linkid.js');var dcdate="2016-07-27";var cmaid="1034486";ga('set','dimension1',dcdate);ga('set','dimension2',cmaid);var dw_canonical="http://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/index.html";dw_canonical=dw_canonical.substring(dw_canonical.indexOf(".ibm.com")+8);ga('send','pageview',{'page':dw_canonical,'dimension1':dcdate,'dimension2':cmaid});var trkOBL=function(url,id){id=id.split("-");var cat="v18 article";var act="Bluemix";if(id[2]=="dwpremium")act="Premium";if(id[2]=="dwopen")act="dWOpen";if(id[2]=="devops")act="Devops";act=act+' '+id[3];if(id[4]){var label=id[4];if(label=="btn")label="button";if(label=="txt")label="text link";if(label=="bnr")label="banner";if(label=="tl")label="tile";if(label=="regbar")label="registration bar";if(label=="vp")label="video promotion"}var ab=0;if(id[5]){if(id[5]=="ABa")ab=1;if(id[5]=="ABb")ab=2;if(id[5]=="ABc")ab=3;if(id[5]=="ABd")ab=4;if(id[5]=="ABe")ab=5;if(id[5]=="ABf")ab=6;if(id[5]=="ABg")ab=7;if(id[5]=="ABh")ab=8}ga('send','event',cat,act,label,ab,{'page':dw_canonical,'hitCallback':function(){document.location=url}})}</script><!-- Piwik -->
<script type="text/javascript">
    var _paq = _paq || [];
    _paq.push(["setDomains", ["*.www.ibm.com/developerworks","*.www.ibm.com/developerworks"]]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
    var u="//developer.ibm.com/piwik/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', 7]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
    })();
</script>
<noscript>&lt;p&gt;&lt;img src="//developer.ibm.com/piwik/piwik.php?idsite=7" style="border:0;" alt="" /&gt;&lt;/p&gt;</noscript>
<!-- End Piwik Code -->
<!-- SCRIPTS_INCLUDE_END -->



<div id="ibm-overlay-backdrop"></div><div class="ibm-common-overlay ibm-overlay-alt-three" id="ibm-overlaywidget-N100A2" role="dialog" aria-describedby="ibm-overlaywidget-N100A2-content" aria-label="Overlay content" data-widget="overlay container" data-name=""><div class="ibm-overlay-heading-con"><p class="ibm-icononly"><a href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#" class="ibm-close-link" role="button">Close</a></p></div><div id="ibm-overlaywidget-N100A2-content" class="content"><div class="" data-widget="overlay" id="N100A2"><img alt="Chart showing the CQRS pattern" src="./Build an application using microservices and CQRS_files/elements.png" width="962"></div></div></div><div class="ibm-common-overlay ibm-overlay-alt-three" id="ibm-overlaywidget-N100C8" role="dialog" aria-describedby="ibm-overlaywidget-N100C8-content" aria-label="Overlay content" data-widget="overlay container" data-name=""><div class="ibm-overlay-heading-con"><p class="ibm-icononly"><a href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#" class="ibm-close-link" role="button">Close</a></p></div><div id="ibm-overlaywidget-N100C8-content" class="content"><div class="" data-widget="overlay" id="N100C8"><img alt="ShoppingCart aggregate object" src="./Build an application using microservices and CQRS_files/shopping_cart.png" width="697"></div></div></div><div class="ibm-common-overlay ibm-overlay-alt-three" id="ibm-overlaywidget-N10173" role="dialog" aria-describedby="ibm-overlaywidget-N10173-content" aria-label="Overlay content" data-widget="overlay container" data-name=""><div class="ibm-overlay-heading-con"><p class="ibm-icononly"><a href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#" class="ibm-close-link" role="button">Close</a></p></div><div id="ibm-overlaywidget-N10173-content" class="content"><div class="" data-widget="overlay" id="N10173"><img alt="Transaction rollback process" src="./Build an application using microservices and CQRS_files/base_transaction.png" width="808"></div></div></div><div class="ibm-common-overlay ibm-overlay-alt-three" id="ibm-overlaywidget-N10198" role="dialog" aria-describedby="ibm-overlaywidget-N10198-content" aria-label="Overlay content" data-widget="overlay container" data-name=""><div class="ibm-overlay-heading-con"><p class="ibm-icononly"><a href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#" class="ibm-close-link" role="button">Close</a></p></div><div id="ibm-overlaywidget-N10198-content" class="content"><div class="" data-widget="overlay" id="N10198"><img alt="SAGA example" src="./Build an application using microservices and CQRS_files/saga.png" width="988"></div></div></div><div class="ibm-common-overlay ibm-overlay-alt-three" id="ibm-overlaywidget-N101C4" role="dialog" aria-describedby="ibm-overlaywidget-N101C4-content" aria-label="Overlay content" data-widget="overlay container" data-name=""><div class="ibm-overlay-heading-con"><p class="ibm-icononly"><a href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#" class="ibm-close-link" role="button">Close</a></p></div><div id="ibm-overlaywidget-N101C4-content" class="content"><div class="" data-widget="overlay" id="N101C4"><img alt="Event store contents" src="./Build an application using microservices and CQRS_files/event_store.png" width="966"></div></div></div><div class="ibm-common-overlay ibm-overlay-alt-three" id="ibm-overlaywidget-N101CF" role="dialog" aria-describedby="ibm-overlaywidget-N101CF-content" aria-label="Overlay content" data-widget="overlay container" data-name=""><div class="ibm-overlay-heading-con"><p class="ibm-icononly"><a href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#" class="ibm-close-link" role="button">Close</a></p></div><div id="ibm-overlaywidget-N101CF-content" class="content"><div class="" data-widget="overlay" id="N101CF"><img alt="DOMAINEVENTENTRY table content sample" src="./Build an application using microservices and CQRS_files/image002.png" width="1240"></div></div></div><div class="ibm-common-overlay ibm-overlay-alt-three" id="ibm-overlaywidget-N101F2" role="dialog" aria-describedby="ibm-overlaywidget-N101F2-content" aria-label="Overlay content" data-widget="overlay container" data-name=""><div class="ibm-overlay-heading-con"><p class="ibm-icononly"><a href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#" class="ibm-close-link" role="button">Close</a></p></div><div id="ibm-overlaywidget-N101F2-content" class="content"><div class="" data-widget="overlay" id="N101F2"><img alt="Clustering event bus" src="./Build an application using microservices and CQRS_files/image003.png" width="894"></div></div></div><div class="ibm-common-overlay ibm-overlay-alt-three" id="ibm-overlaywidget-N1022E" role="dialog" aria-describedby="ibm-overlaywidget-N1022E-content" aria-label="Overlay content" data-widget="overlay container" data-name=""><div class="ibm-overlay-heading-con"><p class="ibm-icononly"><a href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#" class="ibm-close-link" role="button">Close</a></p></div><div id="ibm-overlaywidget-N1022E-content" class="content"><div class="" data-widget="overlay" id="N1022E"><img alt="Shopping cart front end" src="./Build an application using microservices and CQRS_files/image004.png" width="1045"></div></div></div><div class="ibm-common-overlay ibm-overlay-alt-three" id="ibm-overlaywidget-N1026B" role="dialog" aria-describedby="ibm-overlaywidget-N1026B-content" aria-label="Overlay content" data-widget="overlay container" data-name=""><div class="ibm-overlay-heading-con"><p class="ibm-icononly"><a href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#" class="ibm-close-link" role="button">Close</a></p></div><div id="ibm-overlaywidget-N1026B-content" class="content"><div class="" data-widget="overlay" id="N1026B"><img alt="Figure showing single macro deployment" src="./Build an application using microservices and CQRS_files/single_app.png" width="881"></div></div></div><div class="ibm-common-overlay ibm-overlay-alt-three" id="ibm-overlaywidget-N10276" role="dialog" aria-describedby="ibm-overlaywidget-N10276-content" aria-label="Overlay content" data-widget="overlay container" data-name=""><div class="ibm-overlay-heading-con"><p class="ibm-icononly"><a href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#" class="ibm-close-link" role="button">Close</a></p></div><div id="ibm-overlaywidget-N10276-content" class="content"><div class="" data-widget="overlay" id="N10276"><img alt="Figure showing seven macro components" src="./Build an application using microservices and CQRS_files/seven_macros.png" width="887"></div></div></div><div class="ibm-common-overlay ibm-overlay-alt-three" id="ibm-overlaywidget-N10281" role="dialog" aria-describedby="ibm-overlaywidget-N10281-content" aria-label="Overlay content" data-widget="overlay container" data-name=""><div class="ibm-overlay-heading-con"><p class="ibm-icononly"><a href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#" class="ibm-close-link" role="button">Close</a></p></div><div id="ibm-overlaywidget-N10281-content" class="content"><div class="" data-widget="overlay" id="N10281"><img alt="Deployment on Bluemix" src="./Build an application using microservices and CQRS_files/halfway.png" width="819"></div></div></div><div class="ibm-common-overlay ibm-overlay-alt-three" id="ibm-overlaywidget-N10295" role="dialog" aria-describedby="ibm-overlaywidget-N10295-content" aria-label="Overlay content" data-widget="overlay container" data-name=""><div class="ibm-overlay-heading-con"><p class="ibm-icononly"><a href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#" class="ibm-close-link" role="button">Close</a></p></div><div id="ibm-overlaywidget-N10295-content" class="content"><div class="" data-widget="overlay" id="N10295"><img alt="Deployment with Bluemix containers" src="./Build an application using microservices and CQRS_files/containers.png" width="986"></div></div></div><div class="ibm-common-overlay ibm-overlay-alt-three" id="ibm-overlaywidget-N102A3" role="dialog" aria-describedby="ibm-overlaywidget-N102A3-content" aria-label="Overlay content" data-widget="overlay container" data-name=""><div class="ibm-overlay-heading-con"><p class="ibm-icononly"><a href="https://www.ibm.com/developerworks/cloud/library/cl-build-app-using-microservices-and-cqrs-trs/#" class="ibm-close-link" role="button">Close</a></p></div><div id="ibm-overlaywidget-N102A3-content" class="content"><div class="" data-widget="overlay" id="N102A3"><img alt="Console of a Bluemix container" src="./Build an application using microservices and CQRS_files/image005.png" width="1160"></div></div></div><div id="ibm-mobilemenu-screen"></div><div id="ttdUniversalPixelTagaf477d928c164ae0b8f3e1717b910617" style="display:none"><iframe id="universal_pixel" allowtransparency="true" height="0" width="0" style="visibility:hidden;" src="./Build an application using microservices and CQRS_files/up.html"></iframe></div><div id="ttdUniversalPixelTag14a49df88763436db0795df4fc90e6a7" style="display:none"><iframe id="universal_pixel" allowtransparency="true" height="0" width="0" style="visibility:hidden;" src="./Build an application using microservices and CQRS_files/up(1).html"></iframe></div><script async="async" type="text/javascript" crossorigin="" src="./Build an application using microservices and CQRS_files/get"></script><script src="./Build an application using microservices and CQRS_files/js(1)" id="mm_pp_background"></script><script type="text/javascript" src="./Build an application using microservices and CQRS_files/Serving" async=""></script><iframe name="_hjRemoteVarsFrame" title="Hotjar Remote Vars Frame" id="_hjRemoteVarsFrame" src="./Build an application using microservices and CQRS_files/rcj-9a8c65a25e627120fda741095c91ae72.html" style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;"></iframe><iframe src="./Build an application using microservices and CQRS_files/iframe.html" id="mm_sync_back_ground" style="visibility: hidden; display: none;"></iframe><div id="ads"></div></body></html>